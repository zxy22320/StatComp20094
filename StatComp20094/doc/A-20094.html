<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xiangyu Zhang SA20017912" />

<meta name="date" content="2020-12-17" />

<title>A-20094-2020StatComp</title>

<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A-20094-2020StatComp</h1>
<h4 class="author">Xiangyu Zhang SA20017912</h4>
<h4 class="date">2020-12-17</h4>



<div id="section" class="section level2">
<h2>9-22</h2>
</div>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>Summary and analysis of a R dataset Orange which evaluates the age and circumference of different trees.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(stats)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">data</span>(Orange) </a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">summary</span>(Orange)</a></code></pre></div>
<pre><code>##  Tree       age         circumference  
##  3:7   Min.   : 118.0   Min.   : 30.0  
##  1:7   1st Qu.: 484.0   1st Qu.: 65.5  
##  5:7   Median :1004.0   Median :115.0  
##  2:7   Mean   : 922.1   Mean   :115.9  
##  4:7   3rd Qu.:1372.0   3rd Qu.:161.5  
##        Max.   :1582.0   Max.   :214.0</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">aov.circumference &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="kw">sqrt</span>(age) <span class="op">~</span><span class="st"> </span>circumference, <span class="dt">data =</span> Orange)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">summary</span>(aov.circumference) </a></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## circumference  1 2508.0  2508.0   148.2 9.47e-14 ***
## Residuals     33  558.5    16.9                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">  knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(Orange),<span class="dt">caption=</span><span class="st">&quot;Orange trees Data&quot;</span>)</a></code></pre></div>
<table>
<caption>Orange trees Data</caption>
<thead>
<tr class="header">
<th align="left">Tree</th>
<th align="right">age</th>
<th align="right">circumference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">118</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">484</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">664</td>
<td align="right">87</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">1004</td>
<td align="right">115</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">1231</td>
<td align="right">120</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">1372</td>
<td align="right">142</td>
</tr>
</tbody>
</table>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>Continue the last example, we use plots for statistical diagnosis of the Orange dataset.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">opar &lt;-<span class="st"> </span><span class="kw">par</span>() </a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">plot</span>(aov.circumference) </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAz1BMVEUAAAAAADoAAGYAICEAMWYAOnwAOpAASbYAZrYXADoXZtsyAAAyfHs6AAA6ADE6ADo6AGY6Ojo6OpA6fHs6kNs6nP9RMgBYAABYZjpZAABZO2tmAABmADpmAGZmOpBmZmZmkJBmtrZmtv97OgB8ezqQOgCQOjqQZgCQkGaQtpCQtv+QvJCQ27aQ2/+fIQC2ZgC2tma225C2/7a2//++vr7bfCHbkDrbtmbb25Db///fOyvfRzzfU0zfU2v/tkn/tmb/trb/25D//7b//9v///9Pni8EAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQg0lEQVR4nO1dCZvjOBFVNxDC0SxHuLYbhgk0zLIE784MZhoIJmn//9+Ebku2pJJk+crU+2bSsa3DfimVSiVZRVpEEGTpG1g7kCAASBAAJAgAEgQACQKABAFAggAgQQCQIABIEAAkCAASBAAJAoAEAUCCACBBAJAgAEgQACQIABIEAAkCgAQBQIIAIEEAkCAASBAAJAgAEgQACQKABAFAggAgQQCQIABIEAAkCAASBAAJAoAEAUCCACBBAJAgAEgQACQIABIEAAkCgAQBQIIAIEEAkCAASBAAJAhAR9D18dDWhOxeFrybFaIjqNq9XB72bbVf8G5WCE3Q9fHYNoT+v/+w5P2sDhZBFSWnRoIsGE1sf33cvVwfsYlZMJU0uTu9PiM/Nibp5l+fCcfBcY01ZYHm7hS46kU1bz87EUFcDpnODwAJAtrrlgii+kejQC+mmOHPUsu2dnmgX46SAnry7t3diR/wj4pf5N9lQp6F/aFEdqdMgkTJOpGq6fr0jj1EpbJUoq7uTpIwuQTV9NYuD/I5aKMTdNAHaIhBUCVT0u8qoS6n2n3qThkEyZJVohdVE+uMW12irkvfSRqmJKjmAsPuiFqfygAVMsKeteoIuj6dhLzQ76alyowyWoJlvCqCdMkykT7mX3SJRl3yetqzWN18uSYmijoqRUPv8vooCuYWO//amE2MSYhogCqhTsySGTelCDJK5oms41aXqOvS19OexRqL1fv0AlzgEsQGdvwmJVecNaGD6gFBVD3cfyskSCUUN7XnhFinFEG6ZJFIH2stx0vUdXXpk2AMNQ5tQ+uuC3QSook1TCPaXZVsVQMJ4j+LbGIqIf/b3L9X8qBO2RLUJdLHvAxdYk+CkmGNxS4//cD/j4XUQZXQusYF3oKUXqilXqBH/Cka0hHU/X2jWpfmTuugoy71DVdDRyOhLtGoK6ttaIJenw9csxUkiHcnoieRP6ASGnay4SOb3QttPkchPOTAlbRMKIqqyF4eNT0J0iXLRPpYSxAv0e7FtBymE8Qba3Uo2MSYHjgI60P8nIRokZJ2EO8Z3goddHdSDVAkFBCdu3mq0sMYVbKyAORxV8NJ0kfuv2HpdPoUGN081XX0fm/T25Hv5bp5nzTXQcIGysLNEyTMgXzbxejFyo3Fbgl9CUKXdA+DJoazGjYGBKEI2RgQNG5Wg2wGuQSNnNXYTKeYTpDqxcYZ0jdMUBSYsS6sek9DFMV9TCp0EUxDkHCK8oHhZ0ZQnNOeDfjZJxujBwnaADIkiPu3nHMxCoZHpkdQeuewNNIJ0i4Kv5YWEtQyY/Jza2JtJx4hQ1HR4veK5BC0iNzlSJAQj+DEZS2Hxa/P5XQQycs2Elk6SDpvZ6m3l2N2hnK6ed6VjXS4pjexDRFUrl4kqGRxXAfNrqc3RJBkZ2aGki3pQxmXa1ITU3KzRCvbgg7ScvP5EZSQlLSbIajIqwhZBC1hK2YQVORVhIQmZumfDfRiZV5FSNJBS47+8wga/ypCygNvjKAyryLk6aAFkKWkC7yKkKmD5scG7KDPmaD4tFvSQayN7V6q7IU0afXyxGSZgSqvOz1hc3eqmZIexVCeu2MzLtc6MKGTUlwCQUtpojw7iBFUwlBMzLBEI8uXoHFvG+UQxP5twaModFA9Yjlfm9jEuOQQoliaFdlO+9CkRsQEdYY/aBGH4kR2kH86LGPqWannZdR0ng4CAY5E0gg669a1AR0U964H8J5u4lDjfN5QL1Zm9WaqDjpnVFGEzhwJKjerEZuYPur5PDwH1lCAoS0MViUZFkPQ40v+xt/1BtwdmoyzfSp0T0T2ep8FQR0ZZ8c5X5ZSZuUGmphBxtlxzpdFCdFIbIogQrSqDrcfoX8W6sXKIEcHyVYW4z4rZ1MmElRs7470warMco579mI2ZY6hCC4DLllvP4toZe7sctRfVNhzxmLgMuCS9faz6JGZO0HxEX/+WGy+qWczjzQZXbctNXNXehHkj+ZLeBRjCVJ2sXSauUdmayFogWXAXbNhFPGR2SCJ5jC5dLju1ITllgGnpDU7+4EMdepneR1Ust54O8gYODgY0uK1hl6sZL0jCLIYgsauI5DZxGaeem7N1qWynqPHrmOQo6TLTT1HpzbWARs5z9bgdRJ+Mrv5BaaeZbaegjmfJUmTuavzDMVSU8+jX6gTzti+O7Yk8iUoaCiq7e28JJYbavOSzhriqEjpuorEhBFTz7XayLLx7WhZhCCXbhYklWMo21AMGdLG3KJvSFukifk7r2UJAmHMLTaet54/Um4+0g/xd9R/UqAM//9JCIqWoLHo9+5GX1ZKhnJ6MeEPCr71rBTUtDqo37ubfC1JkNxyL9TNgzugFOrmHWUWZiiHoLePfD/HNdhBjjJXQNCRWjmHudcoRpdZWAtlulxrsvvn6gjq6exFCWLbpa+uifV1dhGGcglqrb2tc+udeHOTEkOOZR1mk2M8QzdO0HghSiRomffmR2EkQ1vwSccW6fGZhYUI8rRtoolFuQsDXtcAQ6CvNrmJFV3dEZk2ZuF50G/vFSLY25/jMCu3uiNuCR5RH3CB3lQehqYgqOTqjoLvrEKp3EI0BUElV3ckJI1qY8FETopK66C27OqOuKRRTSxGlTsZKt+LFVzdkb81RfC5vBczzMZsp/2cm7w5+GkDtx66mMzQJuwgT25PGWGdlSpE+TpoHBYjKFWI8nuxAAq/kunLnUlQmhDlKGm4f/e+ktkrLnsslq2DBGIYSn1fyJCgiKFGyVcy3fmzejENWIhIG8N0L0MC4l7JXBAAQ7qdztyL9d56XnI/acALoj4zCCoSBHIUQXxxjdsQUwvfnGPpxg4/d/6XX8rHEBQdBDJkEIwRSOFOcIeQgwiy037pl6J8HRQfBHIiguRPw2MKiLKIKd6iTmeAwQFBx0BDG9GLxQaBhAnKamLql/mfCMrHg/QR9YUTVJPD9fcvrRnX2IqJLC6wz90L+TuRsZHfPorULCbIvlUBjfMs6bggkAkEqdVzvr9WqYYFQTtLwpebiMise7lNaBcAWsc1NmIim8GSSbU/n0UYEBn+URwcVEDjDB0UHQRymiZmrj9mNRDWcl6Vl5PFMyZDh5UVE7kLlkxlhEUy/vePZChlHr73YFTT3Od08yWCQJYhiD03YZ8XIubD6fP9TC1JMud+rYi2OlgyFT92I7R1ftlaoW7bLgDysqP5HB1kNjH+NLSNHQl/LB6+9u6rL04qpdZBdkxktQaX5uORjGnu838UQTJ3Yxls0U9UDAWUdEPkz02fQnyRLcT0dUpjwI6JLPKcGHuEigjPff2tS4KSe7FFpn16MLp5oeWYDnrudJBloklC+nGKCWFP8ig6PxkbmRpFhJ0/mBkXnvbJA7+B12e+zE12XvoLf75KyUt3myomsgipTqWGXmDcXEgXG7ll7YywlKwZy4DGG5j2GcLw+Urzp7XsILnO1Ap1bNpB8gJhwY7/Qf//srr7mplGvJ0R0w66/7DstM9Sg1UxxmICxNaBUb3MDTtyYoYXGSSNLlNg9mmfKUCkaifk+/V3uEZl3SH/5XuG6bLTPsuBN6inr3/+6Yu//e7904kNLq9PcnBqUbSJaZ+J0Oxpy6p+870/HlgL41a5NHsGLzNGYD12UEnQ3/q7v6bDpn0/Tri1zUwUVjUvVgqXn/zqFw/3H6gADd1b6lXG2LK6hODLcmnFLYn/kh8/vGUa6JPX/ZfjUZx7m8DJcHn4wZ/4b/3DWvVkA+R5FMdjDQTRZtUwi/H1z4EOeZKZ1ZTiFoQSG9aHeZE/1BiHNRAUhWxDsUi9i3fzMCaaeoaL4/hI1o9kgkoiVGho7r14tgJPhwQBKDz13C806drKCYqeek4pNOnaugmKn3pOKDTt2toJip16Tig07dq6CYqfek4oNO3augmKn3pOKTTp2soJKjL1PCg05draCUK40ClpOfYtEj3ihjAgaNwmb7cHSVDVjeJK+M1uCAMJQthAJQ1AEXR5OPDZ/3ETqzcISZBeGVlksHpLUEqaOaT5xM+4cOq3B7XC7KDc9mgH2VAEHbsVskiQCYMgueCvwGD1lmDoIL40qMz02A1BEsQXkjLZyZyhtwwEfQCaDe5sLbTOzZ2NzaiW74KVHdTwtVOXh7wGxhad6vWx+sA6G5+N303oPtzZxILX4gwVsaTF+kZpIOgD62x8tlburp9c2z5cWyaKECTVu2id+sA6G5+Nfe7+EiDInW3dBPEXIaSBoA+ss/HZ+NeQDvJkW3MTEwpBqgV9YJ2Nz8ZbTYggT7aJRpIrJAjaWd+TjfW/fMhdFutrYvxLehMDNV4m1qeka+nZ9GoTdzZQXjOxym4+LEHubIKp8iPJMh7F0oZi2JJ2Z1uzDhJvJemRXG0Y/2GRd2droaGGO1s1yYwD+qQBIEEAkCAASBAAJAgAEgQACQKABAFAggAgQQCQIABIEAAkCAASBAAJAoAEAUCCACBBAJAgAEgQACQIABIEAAkCgAQBQIIAIEEAkCAAayBo3N6WEwMJAoAEAVgXQSJigVwLxZYrihUt16d37H3+Sq07q8QWwCr9pFgVQTJigVzyvHuRx618S0K9T6JCIaj0k97cmgjS72Ox9Yc8/LQ8FrtJs7eOmXAZoRBmeH9rTQSpiAVHsb/4yToWKVgb0xvZ6+tT3tyqCNLrW2lroif1sSCIBTr4lrKhQyE00HrYElgVQXqJYnP/XgiROOze92MfPQmaGGsiqNsM9Pr4hquhY9td4Lx0L2bXdsysybAmglTEAvYh9ueXx1qCeKADuxfzxNsqhlUQpDcNqdUufPK1HXmsddDdSdJH7r9h6XT66bAGgrIw19vZGySI66AyuztHYIMECXNgrh00tkjQrECCACBBAJAgAFMQ9Prs06DNMXiZIbxVWKTxXKe7iXz1TkFQ7XvJUBp84Xfbm/H+xSwbwFPvBAT5f2UVkTGYPSxgI+8gvd4RBGkPaGM7SsXmACpaLBsgfMUifb3j44ndizCBA+5T9wY9In4aj4YpHLDdCRHDkAWcPbBqeShamaDz16ojT2Bab735BGkPqAyzpx2l7ILeE62LFMsiWbGnqfZt2H3q9GLIOLIiXCh7EuOEIIi7sBkTzAN51P5bI7k4cgem9dWbT5D2gOpAjaajVI2UDNfEQYg+7D7V0SDFhjR/5bUZMRxlUUZQR07QQW7lJz2QPX+tdeQITPvB55ocpYO4B9QI9XnUET1VUFhBFAump9QP7D6V9856vEoFPFM3r0swT+gwoerjqr1tyl9rHzkC03qHd/kEKQ/oRQWLlY5ScSyjxdYDgqRMBdynrhtVcWQ7gowTboIsf6195AhMW54gfUdagqSjtOtCKi0YfQkKuk+dBGVKkEphHzkC03rqHUGQ9oBqHaQdpaoeHoLYdI9q3RB0n7p0ga2DjuYJoVMGBNn+2sFRPzCtp96REiQ8oDpqrHSUsh5K77wgOglN0EFcDrpPvb0Y7Se7R5cnRGBfMiTI9tfaR+yjF5jWV+84HSQ9oEbUWL1/ho4Wy778QTYxyqC0g0LuU9AOejx2J3i8lLeOJtbz11pHgkBiBqb11juLJa00ouey7T6dZa7CAU+9s4zFLIKsy47+tcBYLAvzjcWGoxqbIOvywH261Mbfc47mbwpIEID/Ay1qEWZULhIaAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">termplot</span>(aov.circumference, <span class="dt">se=</span><span class="ot">TRUE</span>, <span class="dt">partial.resid=</span><span class="ot">TRUE</span>, <span class="dt">rug=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3-with-a-couple-of-latex-formulas" class="section level2">
<h2>Example 3 with a couple of Latex formulas</h2>
<p><span class="math display">\[P(F(X_{(n)})-F(X_{(1)})&gt;\beta)=1-n\beta^{n-1}+(n-1)\beta^{n}.\]</span></p>
<p><span class="math display">\[F_{n}(x)-F(x)\stackrel{CLT}{\longrightarrow}N(0,\frac{F(x)(1-F(x))}{n}).\]</span></p>
</div>
<div id="section-1" class="section level2">
<h2>9-29</h2>
</div>
<div id="exercise-3.3" class="section level2">
<h2>Exercise 3.3</h2>
<p>Qusetion: The Pareto(a,b) distribution has cdf <span class="math inline">\(F(x)=1-(\frac{b}{x})^{a}, x\geq b&gt;0,a&gt;0.\)</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
<p>Solve: First we can derive that <span class="math inline">\(F^{-1}(u)=b/(1-u)^{1/a}.\)</span> The <span class="math inline">\(Pareto(a,b)\)</span> density is <span class="math inline">\(f(x)=ab^{a}x^{-a-1}.\)</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2342</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">pareto&lt;-<span class="cf">function</span>(a,b,n){</a>
<a class="sourceLine" id="cb8-3" title="3">   u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) </a>
<a class="sourceLine" id="cb8-4" title="4">   x &lt;-<span class="st"> </span>b<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>{<span class="dv">1</span><span class="op">/</span>a}</a>
<a class="sourceLine" id="cb8-5" title="5">   <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb8-6" title="6">}</a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8">a&lt;-<span class="kw">pareto</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw">hist</span>(a[a<span class="op">&lt;</span><span class="dv">15</span>], <span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">xlab=</span><span class="st">&#39;x&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;Pareto(2,2)&#39;</span>)</a>
<a class="sourceLine" id="cb8-10" title="10">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">15</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb8-11" title="11"><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">*</span>y<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.9" class="section level2">
<h2>Exercise 3.9</h2>
<p>Question: The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[\begin{equation}\label{3.10} \tag{3.10}
f_{e}(x)=\frac{3}{4}(1-x^{2}), |x|\leq 1.
\end{equation}\]</span> Devroye and Gyorfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_{1},U_{2},U_{3}\)</span> ~ <span class="math inline">\(Uniform(-1,1)\)</span>. If <span class="math inline">\(|U_{3}|\geq |U_{2}|\)</span> and <span class="math inline">\(|U_{3}|\geq |U_{1}|\)</span>, deliver <span class="math inline">\(U_{2}\)</span>; otherwise deliver <span class="math inline">\(U_{3}\)</span>. Write a functionto generate random variates from <span class="math inline">\(f_{e}\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
<p>Solve:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">kernel&lt;-<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb9-3" title="3">   u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>) </a>
<a class="sourceLine" id="cb9-4" title="4">   u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-5" title="5">   u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-6" title="6">   u=<span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&quot;numeric&quot;</span>,<span class="dt">length=</span>n)</a>
<a class="sourceLine" id="cb9-7" title="7">   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb9-8" title="8">      <span class="cf">if</span>(<span class="kw">abs</span>(u3[i])<span class="op">&lt;</span><span class="kw">abs</span>(u2[i])<span class="op">||</span><span class="kw">abs</span>(u3[i])<span class="op">&lt;</span><span class="kw">abs</span>(u1[i])) u[i]=u3[i]</a>
<a class="sourceLine" id="cb9-9" title="9">      <span class="cf">else</span> u[i]=u2[i]</a>
<a class="sourceLine" id="cb9-10" title="10">   }</a>
<a class="sourceLine" id="cb9-11" title="11">   <span class="kw">return</span>(u)</a>
<a class="sourceLine" id="cb9-12" title="12">}</a>
<a class="sourceLine" id="cb9-13" title="13"></a>
<a class="sourceLine" id="cb9-14" title="14">a&lt;-<span class="kw">kernel</span>(<span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb9-15" title="15"></a>
<a class="sourceLine" id="cb9-16" title="16"></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="kw">hist</span>(a, <span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">xlab=</span><span class="st">&#39;x&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;kernel&#39;</span>)</a>
<a class="sourceLine" id="cb9-18" title="18">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb9-19" title="19"><span class="kw">lines</span>(y, <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span>{<span class="dv">2</span>}))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.10" class="section level2">
<h2>Exercise 3.10</h2>
<p>Question: Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_{e}\)</span> (3.10).</p>
<p>Solve: From the defination of density function: <span class="math inline">\(f(x)=\lim_{\Delta x \to 0} \frac{P(x&lt;U&lt;x+\Delta x)}{\Delta x}.\)</span></p>
<p>Following total probability formula, we have: <span class="math display">\[\begin{align}
&amp; P(x&lt;U&lt;x+\Delta x)\nonumber\\
=&amp; P(U=U_{2},x&lt;U_{2}&lt;x+\Delta x)+P(U=U_{3},x&lt;U_{3}&lt;x+\Delta x)\nonumber\\
=&amp; P(U=U_{2}|x&lt;U_{2}&lt;x+\Delta x)P(x&lt;U_{2}&lt;x+\Delta x)+P(U=U_{3}|x&lt;U_{3}&lt;x+\Delta x)P(x&lt;U_{3}&lt;x+\Delta x)\nonumber
\end{align}\]</span> As <span class="math inline">\(U_{1},U_{2},U_{3}\)</span> ~ <span class="math inline">\(Uniform(-1,1)\)</span>, we have <span class="math inline">\(P(x&lt;U_{i}&lt;x+\Delta x)=\frac{\Delta x}{2}\)</span>, for <span class="math inline">\(i=1,2,3\)</span> and <span class="math inline">\(|U_{1}|,|U_{2}|,|U_{3}|\)</span> ~ <span class="math inline">\(Uniform(0,1)\)</span>.</p>
<p>Therefore, when <span class="math inline">\(\Delta x \rightarrow 0\)</span>: <span class="math display">\[\begin{align}
&amp; P(U=U_{2}|x&lt;U_{2}&lt;x+\Delta x)\nonumber\\
=&amp; \int_{|x|}^{1}\int_{0}^{|u_{3}|}1d|u_{1}|d|u_{3}|\nonumber\\
=&amp; \frac{1-x^{2}}{2}\nonumber
\end{align}\]</span></p>
<p><span class="math display">\[\begin{align}
&amp; P(U=U_{3}|x&lt;U_{3}&lt;x+\Delta x)\nonumber\\
=&amp; 1-P(|U_{3}|\geq|U_{1}| and |U_{3}|\geq|U_{1}|\  |x&lt;U_{3}&lt;x+\Delta x)\nonumber\\
=&amp; 1-x^{2}\nonumber
\end{align}\]</span></p>
<p>Thus, <span class="math display">\[f(x)=\lim_{\Delta x \to 0} (\frac{1-x^{2}}{2}\frac{\Delta x}{2}+(1-x^{2})\frac{\Delta x}{2})/\Delta x.=\frac{3}{4}(1-x^{2}).\]</span></p>
</div>
<div id="exercise-3.12" class="section level2">
<h2>Exercise 3.12</h2>
<p>Question: It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math inline">\(F(y)=1-(\frac{\beta}{\beta +y})^{\gamma}, y\geq 0.\)</span></p>
<p>(This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(\gamma=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
<p>Solve:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1645</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">n &lt;-<span class="st"> </span><span class="fl">1e3</span></a>
<a class="sourceLine" id="cb10-3" title="3">r &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb10-4" title="4">beta &lt;-<span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb10-5" title="5">lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, r, beta) </a>
<a class="sourceLine" id="cb10-6" title="6">y &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, lambda)</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="kw">hist</span>(y[y<span class="op">&lt;</span><span class="dv">10</span>], <span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">xlab=</span><span class="st">&#39;y&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;mixture&#39;</span>)</a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9">t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb10-10" title="10"><span class="kw">lines</span>(t, <span class="dv">64</span><span class="op">*</span>(t<span class="op">+</span><span class="dv">2</span>)<span class="op">^</span>{<span class="op">-</span><span class="dv">5</span>})</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>#10-13</p>
</div>
<div id="exercise-5.1" class="section level2">
<h2>Exercise 5.1</h2>
<p>Qusetion: Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi /3}\sin tdt\]</span> and compare your estimate with the exact value of the intergral.</p>
<p>Solve: The exact value of the intergral is <span class="math display">\[\int_{0}^{\pi /3}\sin tdt=\cos0-\cos \frac{\pi}{3}=1-0.5=0.5.\]</span></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb11-2" title="2">m &lt;-<span class="st"> </span><span class="fl">1e4</span>; </a>
<a class="sourceLine" id="cb11-3" title="3">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb11-4" title="4">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span> </a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">print</span>(theta.hat)</a></code></pre></div>
<pre><code>## [1] 0.5005534</code></pre>
<p>Thus the result computed by Monte Carlo estimate is extremely close to the true value.</p>
</div>
<div id="exercise-5.7" class="section level2">
<h2>Exercise 5.7</h2>
<p>Qusetion: Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
<p>Solve: In exercise 5.6, we can derive that <span class="math display">\[Var(U_{1})=E(U_{1}^{2})-E(U_{1})^{2}=\int_{0}^{1}e^{2x}dx-(\int_{0}^{1}e^{x}dx)^{2}=2e-0.5e^{2}-1.5.\]</span> <span class="math display">\[Var(U_{2})=E(U_{2}^{2})-E(U_{2})^{2}=\int_{0}^{1}e^{2-2x}dx-(\int_{0}^{1}e^{1-x}dx)^{2}=2e-0.5e^{2}-1.5.\]</span> <span class="math display">\[Cov(U_{1},U_{2})=E(U_{1}U_{2})-E(U_{1})E(U_{2})=\int_{0}^{1}e^{x}e^{1-x}dx-\int_{0}^{1}e^{x}dx \int_{0}^{1}e^{1-x}dx=3e-e^{2}-1.\]</span> where <span class="math inline">\(U_{1}=e^{X}\)</span>, <span class="math inline">\(U_{2}=e^{1-X}\)</span>, <span class="math inline">\(X\sim U[0,1]\)</span>.</p>
<p>Thus the variance reduction is <span class="math display">\[1-(Var(U_{1})+Var(U_{2})-2Cov(U_{1},U_{2}))/(4Var(U_{1}))=1-\frac{5e-1.5e^{2}-2.5}{2e-0.5e^{2}-1.5}=0.968.\]</span></p>
<p>We use the following program:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">set.seed</span>(<span class="dv">7912</span>)</a>
<a class="sourceLine" id="cb13-2" title="2"></a>
<a class="sourceLine" id="cb13-3" title="3">myanti&lt;-<span class="cf">function</span>(<span class="dt">n=</span><span class="dv">1000</span>, <span class="dt">anti=</span><span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb13-4" title="4">   t&lt;-<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-5" title="5">   <span class="cf">if</span> (<span class="op">!</span>anti) s&lt;-<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>) </a>
<a class="sourceLine" id="cb13-6" title="6">   <span class="cf">else</span> s&lt;-<span class="dv">1</span><span class="op">-</span>t</a>
<a class="sourceLine" id="cb13-7" title="7">   x&lt;-<span class="kw">c</span>(t, s)</a>
<a class="sourceLine" id="cb13-8" title="8">   g&lt;-<span class="kw">exp</span>(x)</a>
<a class="sourceLine" id="cb13-9" title="9">   <span class="kw">mean</span>(g)</a>
<a class="sourceLine" id="cb13-10" title="10">}</a>
<a class="sourceLine" id="cb13-11" title="11"></a>
<a class="sourceLine" id="cb13-12" title="12">m&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb13-13" title="13">mcint1=mcint2=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb13-14" title="14"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb13-15" title="15">   mcint1[i]&lt;-<span class="kw">myanti</span>(<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">anti=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-16" title="16">   mcint2[i]&lt;-<span class="kw">myanti</span>(<span class="dt">n=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb13-17" title="17">}</a>
<a class="sourceLine" id="cb13-18" title="18"></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="kw">c</span>(<span class="kw">var</span>(mcint1),<span class="kw">var</span>(mcint2),(<span class="kw">var</span>(mcint1)<span class="op">-</span><span class="kw">var</span>(mcint2))<span class="op">/</span><span class="kw">var</span>(mcint1)) </a></code></pre></div>
<pre><code>## [1] 2.405110e-04 7.778514e-06 9.676584e-01</code></pre>
<p>Thus the empirical estimate is close to the theoretical value.</p>
</div>
<div id="exercise-5.11" class="section level2">
<h2>Exercise 5.11</h2>
<p>Qusetion: If <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are antithetic, we derived that <span class="math inline">\(c^{*}=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_{c}=c\hat{\theta}_{1}+(1-c)\hat{\theta}_{2}\)</span>. Derive <span class="math inline">\(c^{*}\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_{c}=c\hat{\theta}_{1}+(1-c)\hat{\theta}_{2}\)</span> in equation (5.11). (<span class="math inline">\(c^{*}\)</span> will be a function of the variances and the covariance of the estimators.)</p>
<p>Solve: We calculate the variance of <span class="math inline">\(\hat{\theta_{c}}\)</span>: <span class="math display">\[\begin{align}
Var(\hat{\theta}_{c})=&amp;Var(c\hat{\theta}_{1}+(1-c)\hat{\theta}_{2})\nonumber\\
=&amp;c^{2}Var(\hat{\theta}_{1})+(1-c)^{2}Var(\hat{\theta}_{2})+2c(1-c)Cov(\hat{\theta}_{1},\hat{\theta}_{2})\nonumber\\
=&amp;(Var(\hat{\theta}_{1})+Var(\hat{\theta}_{2})-2Cov(\hat{\theta}_{1},\hat{\theta}_{2}))c^{2}+(2Cov(\hat{\theta}_{1},\hat{\theta}_{2})-2Var(\hat{\theta}_{2}))c+Var(\hat{\theta}_{2})\nonumber\\
=&amp;ac^{2}+bc+Var(\hat{\theta}_{2})\quad (*),
\end{align}\]</span> where <span class="math inline">\(a=Var(\hat{\theta}_{1})+Var(\hat{\theta}_{2})-2Cov(\hat{\theta}_{1},\hat{\theta}_{2})\)</span>, <span class="math inline">\(b=2Cov(\hat{\theta}_{1},\hat{\theta}_{2})-2Var(\hat{\theta}_{2})\)</span>.</p>
<p>Because <span class="math inline">\(Var(\hat{\theta}_{1})+Var(\hat{\theta}_{2})&gt;Cov(\hat{\theta}_{1},\hat{\theta}_{2})\)</span> whenever <span class="math inline">\(\hat{\theta}_{1}\not= \hat{\theta}_{2}\)</span>. Thus <span class="math inline">\((*)\)</span> is a quadratic function with the minimum value achieved at <span class="math display">\[c^{*}=-\frac{b}{2a}=(Var(\hat{\theta}_{2})-Cov(\hat{\theta}_{1},\hat{\theta}_{2}))/(Var(\hat{\theta}_{1})+Var(\hat{\theta}_{2})-2Cov(\hat{\theta}_{1},\hat{\theta}_{2})).\]</span></p>
</div>
<div id="section-2" class="section level2">
<h2>10-20</h2>
</div>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2},\quad x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2}dx\]</span> by importance sampling? Explain.</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> The two importance functions we find is: <span class="math display">\[f_{1}(x)=\frac{1}{x^{2}},\quad f_{2}(x)=\sqrt{\frac{2}{\pi}}e^{-(x-1)^{2}/2},\quad x&gt;1,\]</span> both functions are supported on <span class="math inline">\((1,\infty)\)</span>.</p>
<p>We generate random variable with pdf <span class="math inline">\(f_{1}(x)\)</span> by the inverse transform method, and generate random variable with pdf <span class="math inline">\(f_{2}(x)\)</span> by first generating variable of <span class="math inline">\(N(1,1)\)</span> and then transform those x below 1 to 2-x.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">set.seed</span>(<span class="dv">22320</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb15-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb15-4" title="4">x1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u) </a>
<a class="sourceLine" id="cb15-5" title="5"></a>
<a class="sourceLine" id="cb15-6" title="6">x2=<span class="kw">rnorm</span>(n,<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-7" title="7">x2[x2<span class="op">&lt;</span><span class="dv">1</span>]=<span class="dv">2</span><span class="op">-</span>x2[x2<span class="op">&lt;</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb15-8" title="8"></a>
<a class="sourceLine" id="cb15-9" title="9">a=<span class="kw">exp</span>(<span class="op">-</span>x1<span class="op">*</span>x1<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>x1<span class="op">*</span>x1<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>x1<span class="op">*</span>x1</a>
<a class="sourceLine" id="cb15-10" title="10">b=<span class="kw">exp</span>(<span class="op">-</span>x2<span class="op">*</span>x2<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>x2<span class="op">*</span>x2<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(x2<span class="dv">-1</span>)<span class="op">*</span>(x2<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span>pi))</a></code></pre></div>
<p>Mean value of the integration when the importance function is <span class="math inline">\(f_{1}(x)/f_{2}(x)\)</span>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">c</span>(<span class="kw">mean</span>(a),<span class="kw">mean</span>(b))</a></code></pre></div>
<pre><code>## [1] 0.4029254 0.4005604</code></pre>
<p>Standard deviation of the integration when the importance function is <span class="math inline">\(f_{1}(x)/f_{2}(x)\)</span>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">c</span>(<span class="kw">sd</span>(a),<span class="kw">sd</span>(b))</a></code></pre></div>
<pre><code>## [1] 0.3101416 0.0449082</code></pre>
<p>From the results we observe that variance is obviously smaller when we choose <span class="math inline">\(f_{2}(x)\)</span> as the importance function, which can be explained by the following plot, which shows that <span class="math inline">\(g(x)/f_{2}(x)\)</span> is much closer to a constant.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb20-2" title="2">w &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb20-3" title="3">g &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">*</span>x<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>x<span class="op">*</span>x<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</a>
<a class="sourceLine" id="cb20-4" title="4">f1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(x<span class="op">*</span>x)</a>
<a class="sourceLine" id="cb20-5" title="5">f2 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>)<span class="op">*</span>(x<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span>pi)</a>
<a class="sourceLine" id="cb20-6" title="6">gs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">g</span>(x)<span class="op">==</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span>{<span class="dv">2</span>}<span class="op">/</span><span class="dv">2</span>}<span class="op">*</span>x<span class="op">^</span>{<span class="dv">2</span>}<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)),</a>
<a class="sourceLine" id="cb20-7" title="7">        <span class="kw">expression</span>(f[<span class="dv">1</span>](x)<span class="op">==</span><span class="dv">1</span><span class="op">/</span>x<span class="op">^</span>{<span class="dv">2</span>}),</a>
<a class="sourceLine" id="cb20-8" title="8">        <span class="kw">expression</span>(f[<span class="dv">2</span>](x)<span class="op">==</span>e<span class="op">^</span>{<span class="op">-</span>(x<span class="dv">-1</span>)<span class="op">^</span>{<span class="dv">2</span>}<span class="op">/</span><span class="dv">2</span>}<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span>pi)))</a>
<a class="sourceLine" id="cb20-9" title="9"><span class="co">#for color change lty to col</span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb20-11" title="11"><span class="co">#figure (a)</span></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="kw">plot</span>(x, g, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb20-13" title="13">      <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">main=</span><span class="st">&#39;pdf&#39;</span>)</a>
<a class="sourceLine" id="cb20-14" title="14"><span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-15" title="15"><span class="kw">lines</span>(x, f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb20-16" title="16"></a>
<a class="sourceLine" id="cb20-17" title="17"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs,</a>
<a class="sourceLine" id="cb20-18" title="18">       <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb20-19" title="19"></a>
<a class="sourceLine" id="cb20-20" title="20"><span class="co">#figure (b)</span></a>
<a class="sourceLine" id="cb20-21" title="21"><span class="kw">plot</span>(x, g<span class="op">/</span>f1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb20-22" title="22">     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.0</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">&#39;g(x)/f(x)&#39;</span>)</a>
<a class="sourceLine" id="cb20-23" title="23"><span class="kw">lines</span>(x, g<span class="op">/</span>f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb20-24" title="24"></a>
<a class="sourceLine" id="cb20-25" title="25"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs[<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb20-26" title="26">       <span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-5.15" class="section level2">
<h2>Exercise 5.15</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> We use the following algorithm to generate the variable when the number of subintervals is five:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">M=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb21-2" title="2">k=<span class="dv">5</span></a>
<a class="sourceLine" id="cb21-3" title="3">r=M<span class="op">/</span>k</a>
<a class="sourceLine" id="cb21-4" title="4">N=<span class="dv">100</span></a>
<a class="sourceLine" id="cb21-5" title="5">theta&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb21-6" title="6">T=<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb21-7" title="7">g=<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-8" title="8">f=<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb21-9" title="9">a=<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb21-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb21-11" title="11">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) a[j]=<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb21-12" title="12">  <span class="co">#a=(1-exp(-1))/5</span></a>
<a class="sourceLine" id="cb21-13" title="13">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb21-14" title="14">    u=<span class="kw">runif</span>(r,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-15" title="15">    x=<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>a[j]<span class="op">*</span>u)</a>
<a class="sourceLine" id="cb21-16" title="16">    T[j]=<span class="kw">mean</span>(a[j]<span class="op">*</span><span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">f</span>(x)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb21-17" title="17">  }</a>
<a class="sourceLine" id="cb21-18" title="18">  theta[i]=<span class="kw">sum</span>(T)</a>
<a class="sourceLine" id="cb21-19" title="19">}</a></code></pre></div>
<p>We generate 10000 relicates for each time and repeat this experiment for 100 times, which shows the estimate and estimated standard error are:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">c</span>(<span class="kw">mean</span>(theta),<span class="kw">sd</span>(theta))</a></code></pre></div>
<pre><code>## [1] 0.5248454424 0.0005565196</code></pre>
</div>
<div id="exercise-6.4" class="section level2">
<h2>Exercise 6.4</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Suppose that <span class="math inline">\(X_{1},...,X_{n}\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> As <span class="math inline">\(X_{1},...,X_{n}\)</span> are a random sample from a lognormal distribution with unknown parameters, thus <span class="math inline">\(log(X_{1}),...,log(X_{n})\)</span> are a random sample from a normal distribution <span class="math inline">\(N(\mu,\sigma^{2})\)</span>. Denote <span class="math inline">\(Y_{i}=log(X_{i})\)</span>. As <span class="math inline">\(\hat{\mu}=\bar{Y}=\frac{1}{n}(\sum\limits_{i=1}^{n}Y_{i})\)</span> is an unbiased estimation of <span class="math inline">\(\mu\)</span>, while <span class="math inline">\(\hat{\sigma^{2}}=\frac{1}{n-1}\sum\limits_{i=1}^{n}(Y_{i}-\bar{Y})^{2}\)</span> is an unbiased estimation of <span class="math inline">\(\sigma^{2}\)</span>. Therefore a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span> is <span class="math inline">\((\hat{\mu}-t_{n-1}(0.975)\hat{\sigma}/\sqrt{n},\hat{\mu}+t_{n-1}(0.975)\hat{\sigma}/\sqrt{n})\)</span>.</p>
<p>For the ith repetition, we calculate <span class="math inline">\(p_{i}=2(1-F_{t_{n-1}}(|\sqrt{n}(\hat{\mu}-\mu)/\hat{\sigma}|))\)</span>, where <span class="math inline">\(F_{t_{n-1}}\)</span> is the distribution function of <span class="math inline">\(t_{n-1}\)</span>. Thus an empirical estimate of the confidence level is <span class="math inline">\(\frac{1}{n}\sum\limits_{i=1}^{n}I_{p_{i}\leq 0.05}\)</span>.</p>
<p>Now we use a Monte Carlo method to obtain an empirical estimate of the confidence level where <span class="math inline">\(\mu=0,\sigma^{2}=1\)</span>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb24-2" title="2">sigma &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># Null hypothesis!</span></a>
<a class="sourceLine" id="cb24-3" title="3">m&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb24-4" title="4">n&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb24-6" title="6">mu_hat&lt;-sigma_hat&lt;-pval&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb24-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb24-8" title="8">  x&lt;-<span class="kw">rnorm</span>(n,mu,<span class="kw">sqrt</span>(sigma))</a>
<a class="sourceLine" id="cb24-9" title="9">  mu_hat[i]&lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb24-10" title="10">  sigma_hat[i]&lt;-<span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb24-11" title="11">  pval[i]&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span>(mu_hat[i]<span class="op">-</span>mu)<span class="op">/</span>sigma_hat[i]),n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb24-12" title="12">}</a></code></pre></div>
<p>Thus the empirical confidence level is:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">print</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(pval<span class="op">&lt;=</span><span class="fl">0.05</span>))</a></code></pre></div>
<pre><code>## [1] 0.9512</code></pre>
</div>
<div id="exercise-6.5" class="section level2">
<h2>Exercise 6.5</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>For <span class="math inline">\(Y\sim \chi^{2}(2)\)</span>, we have <span class="math inline">\(EY=\mu=2,Var(Y)=\sigma^{2}=4\)</span>. We estimate the coverage probability of the symmetric t-interval:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb27-2" title="2">sigma &lt;-<span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb27-3" title="3">m&lt;-<span class="fl">1e5</span></a>
<a class="sourceLine" id="cb27-4" title="4">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb27-6" title="6">mu_hat&lt;-sigma_hat&lt;-pval&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb27-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb27-8" title="8">  x&lt;-<span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-9" title="9">  mu_hat[i]&lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb27-10" title="10">  sigma_hat[i]&lt;-<span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb27-11" title="11">  pval[i]&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span>(mu_hat[i]<span class="op">-</span>mu)<span class="op">/</span>sigma_hat[i]),n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb27-12" title="12">}</a></code></pre></div>
<p>Thus the coverage probability of the symmetric t-interval is:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">print</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(pval<span class="op">&lt;=</span><span class="fl">0.05</span>))</a></code></pre></div>
<pre><code>## [1] 0.91807</code></pre>
<p>Compared with Example 6.4:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">alpha=<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb30-2" title="2">m&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb30-3" title="3">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb30-5" title="5">UCL&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb30-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb30-7" title="7">  x&lt;-<span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-8" title="8">  UCL[i]&lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb30-9" title="9">}</a></code></pre></div>
<p>The coverage probability of the interval for variance is:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">print</span>(<span class="kw">mean</span>(UCL<span class="op">&lt;</span><span class="dv">4</span>))</a></code></pre></div>
<pre><code>## [1] 0.2143</code></pre>
<p>Although not extremely close to 0.95, the t-interval is still quite robust.</p>
</div>
<div id="section-3" class="section level2">
<h2>10-27</h2>
</div>
<div id="exercise-6.7" class="section level2">
<h2>Exercise 6.7</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span> We first calculate the power of skewness test under symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb33-3" title="3">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb33-4" title="4">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb33-5" title="5">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb33-6" title="6"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb33-7" title="7">}</a>
<a class="sourceLine" id="cb33-8" title="8">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb33-9" title="9">m &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb33-10" title="10">nu &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-11" title="11">N &lt;-<span class="st"> </span><span class="kw">length</span>(nu)</a>
<a class="sourceLine" id="cb33-12" title="12">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb33-13" title="13"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb33-14" title="14">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb33-15" title="15"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb33-16" title="16">   e &lt;-<span class="st"> </span>nu[j]</a>
<a class="sourceLine" id="cb33-17" title="17">   sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb33-18" title="18">   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb33-19" title="19">      x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,e,e)</a>
<a class="sourceLine" id="cb33-20" title="20">      sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb33-21" title="21">   }</a>
<a class="sourceLine" id="cb33-22" title="22">   pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb33-23" title="23">}</a>
<a class="sourceLine" id="cb33-24" title="24"><span class="co">#plot power vs nu</span></a>
<a class="sourceLine" id="cb33-25" title="25"><span class="kw">plot</span>(nu, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="st">&#39;a&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),<span class="dt">main=</span><span class="st">&#39;Power of the skewness test against the Beta(a,a) distribution&#39;</span>)</a>
<a class="sourceLine" id="cb33-26" title="26"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb33-27" title="27">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb33-28" title="28"><span class="kw">lines</span>(nu, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb33-29" title="29"><span class="kw">lines</span>(nu, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From this plot we can see that when the <span class="math inline">\(\alpha\)</span> we selected is small, the power of the test is always below 0.05, thus cannot efficiently reject the hypothesis of normality. However, as <span class="math inline">\(alpha\)</span> increases, the power becomes closer to 0.05.</p>
<p>We further consider distribution <span class="math inline">\(t(\nu)\)</span>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb34-3" title="3">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb34-4" title="4">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb34-5" title="5">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb34-6" title="6"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb34-7" title="7">}</a>
<a class="sourceLine" id="cb34-8" title="8">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb34-9" title="9">m &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb34-10" title="10">nu &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb34-11" title="11">N &lt;-<span class="st"> </span><span class="kw">length</span>(nu)</a>
<a class="sourceLine" id="cb34-12" title="12">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb34-13" title="13"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb34-14" title="14">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb34-15" title="15"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb34-16" title="16">   e &lt;-<span class="st"> </span>nu[j]</a>
<a class="sourceLine" id="cb34-17" title="17">   sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb34-18" title="18">   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb34-19" title="19">      x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,e)</a>
<a class="sourceLine" id="cb34-20" title="20">      sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb34-21" title="21">   }</a>
<a class="sourceLine" id="cb34-22" title="22">   pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb34-23" title="23">}</a>
<a class="sourceLine" id="cb34-24" title="24"><span class="co">#plot power vs nu</span></a>
<a class="sourceLine" id="cb34-25" title="25"><span class="kw">plot</span>(nu, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="st">&#39;v&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&#39;Power of the skewness test against the t(v) distribution&#39;</span>)</a>
<a class="sourceLine" id="cb34-26" title="26"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb34-27" title="27">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb34-28" title="28"><span class="kw">lines</span>(nu, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb34-29" title="29"><span class="kw">lines</span>(nu, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot we indicate that for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>, when <span class="math inline">\(\nu\)</span> is rather small, the power of skewness test is high, which means the test tend to rejects the hypothesis of normality correctly. However, when <span class="math inline">\(\nu\)</span> is large, <span class="math inline">\(t(\nu)\)</span> becomes closer to normal distribution, and the power of the test will decrease to 0.05.</p>
</div>
<div id="exercise-6.8" class="section level2">
<h2>Exercise 6.8</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}=0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span> We fisrt define the R function used to conduct Count Five test and <span class="math inline">\(F\)</span> test under certain parameters:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb35-2" title="2">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb35-3" title="3">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb35-4" title="4">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb35-5" title="5">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb35-6" title="6">  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb35-7" title="7">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb35-8" title="8">}</a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co">#m: number of replicates; n: sample size</span></a>
<a class="sourceLine" id="cb35-10" title="10">varcount&lt;-<span class="cf">function</span>(sigma1,sigma2,m,n){</a>
<a class="sourceLine" id="cb35-11" title="11">  <span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb35-12" title="12">    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</a>
<a class="sourceLine" id="cb35-13" title="13">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</a>
<a class="sourceLine" id="cb35-14" title="14">    <span class="kw">count5test</span>(x, y)</a>
<a class="sourceLine" id="cb35-15" title="15">  }))</a>
<a class="sourceLine" id="cb35-16" title="16">}</a>
<a class="sourceLine" id="cb35-17" title="17"></a>
<a class="sourceLine" id="cb35-18" title="18">varftest&lt;-<span class="cf">function</span>(sigma1,sigma2,m,n){</a>
<a class="sourceLine" id="cb35-19" title="19">  <span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb35-20" title="20">    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</a>
<a class="sourceLine" id="cb35-21" title="21">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</a>
<a class="sourceLine" id="cb35-22" title="22">    a &lt;-<span class="st"> </span><span class="kw">var.test</span>(x, y)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb35-23" title="23">    <span class="kw">as.integer</span>(a <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.055</span>)</a>
<a class="sourceLine" id="cb35-24" title="24">  }))</a>
<a class="sourceLine" id="cb35-25" title="25">}</a></code></pre></div>
<p>We compare the power of the Count Five test and <span class="math inline">\(F\)</span> test at significance level <span class="math inline">\(\hat{\alpha}=0.055\)</span>:</p>
<ol style="list-style-type: decimal">
<li>When is sample size is small<span class="math inline">\((n=20)\)</span>:</li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">varcount</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">200</span>,<span class="dv">20</span>),<span class="kw">varftest</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">200</span>,<span class="dv">20</span>)))</a></code></pre></div>
<pre><code>## [1] 0.410 0.405</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>When is sample size is medium<span class="math inline">\((n=50)\)</span>:</li>
</ol>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">varcount</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">200</span>,<span class="dv">50</span>),<span class="kw">varftest</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">200</span>,<span class="dv">50</span>)))</a></code></pre></div>
<pre><code>## [1] 0.655 0.830</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>When is sample size is large<span class="math inline">\((n=100)\)</span>:</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">varcount</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">200</span>,<span class="dv">100</span>),<span class="kw">varftest</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">200</span>,<span class="dv">100</span>)))</a></code></pre></div>
<pre><code>## [1] 0.875 1.000</code></pre>
<p>From the results we see that for every sample size we choose, F test is always more powerful than Count Five test.</p>
</div>
<div id="exercise-6.c" class="section level2">
<h2>Exercise 6.C</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^{T}\Sigma^{-1}(Y-\mu)]^{3}.\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^{2}}\sum\limits_{i,j=1}^{n}((X_{i}-\bar{X})^{T}\hat{\Sigma}^{-1}(X_{j}-\bar{X}))^{3}.\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span> We first repeat Example 6.8 which evaluate t1e rate of Mardia’s multivariate skewness test. In our simulation we generate variables following <span class="math inline">\(N(\mu,\Sigma)\)</span>, where: <span class="math display">\[\mu=(0,0,0)^{T} , \Sigma=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb42-2" title="2">Mardia&lt;-<span class="cf">function</span>(mydata){</a>
<a class="sourceLine" id="cb42-3" title="3">  n=<span class="kw">nrow</span>(mydata)</a>
<a class="sourceLine" id="cb42-4" title="4">  c=<span class="kw">ncol</span>(mydata)</a>
<a class="sourceLine" id="cb42-5" title="5">  central&lt;-mydata</a>
<a class="sourceLine" id="cb42-6" title="6">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>c){</a>
<a class="sourceLine" id="cb42-7" title="7">    central[,i]&lt;-mydata[,i]<span class="op">-</span><span class="kw">mean</span>(mydata[,i])</a>
<a class="sourceLine" id="cb42-8" title="8">  }</a>
<a class="sourceLine" id="cb42-9" title="9">  sigmah&lt;-<span class="kw">t</span>(central)<span class="op">%*%</span>central<span class="op">/</span>n</a>
<a class="sourceLine" id="cb42-10" title="10">  a&lt;-central<span class="op">%*%</span><span class="kw">solve</span>(sigmah)<span class="op">%*%</span><span class="kw">t</span>(central)</a>
<a class="sourceLine" id="cb42-11" title="11">  b&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>(a<span class="op">^</span>{<span class="dv">3</span>}))<span class="op">/</span>(n<span class="op">*</span>n)</a>
<a class="sourceLine" id="cb42-12" title="12">  test&lt;-n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb42-13" title="13">  chi&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,c<span class="op">*</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(c<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb42-14" title="14">  <span class="kw">as.integer</span>(test<span class="op">&gt;</span>chi)</a>
<a class="sourceLine" id="cb42-15" title="15">}</a>
<a class="sourceLine" id="cb42-16" title="16"></a>
<a class="sourceLine" id="cb42-17" title="17"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb42-18" title="18">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb42-19" title="19">sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb42-20" title="20">m=<span class="dv">200</span></a>
<a class="sourceLine" id="cb42-21" title="21">n&lt;-<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb42-22" title="22"><span class="co">#m: number of replicates; n: sample size</span></a>
<a class="sourceLine" id="cb42-23" title="23">a=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb42-24" title="24"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb42-25" title="25">  a[i]=<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb42-26" title="26">    mydata &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma) </a>
<a class="sourceLine" id="cb42-27" title="27">    <span class="kw">Mardia</span>(mydata)</a>
<a class="sourceLine" id="cb42-28" title="28">  }))</a>
<a class="sourceLine" id="cb42-29" title="29">}</a></code></pre></div>
<p>We calculate the t1e when the sample size is 10, 20, 30, 50, 100, 500:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">print</span>(a)</a></code></pre></div>
<pre><code>## [1] 0.005 0.025 0.025 0.055 0.055 0.045</code></pre>
<p>From the result we can see that t1e rate is close to 0.05 after the sample size is large than 50.</p>
<p>We further repeat Example 6.8 which evaluate the power of Mardia’s multivariate skewness test under distribution <span class="math inline">\((1-\epsilon)N(\mu_{1},\Sigma_{1})+\epsilon N(\mu_{2},\Sigma_{2})\)</span>, where: <span class="math display">\[\mu_{1}=\mu_{2}=(0,0,0)^{T}, \Sigma_{1}=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right)
\Sigma_{2}=\left( \begin{array}{ccc}
100 &amp; 0 &amp; 0 \\
0 &amp; 100 &amp; 0 \\
0 &amp; 0 &amp; 100 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw">set.seed</span>(<span class="dv">7912</span>)</a>
<a class="sourceLine" id="cb45-3" title="3"><span class="kw">set.seed</span>(<span class="dv">7912</span>)</a>
<a class="sourceLine" id="cb45-4" title="4">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb45-5" title="5">sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-6" title="6">sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-7" title="7">sigma=<span class="kw">list</span>(sigma1,sigma2)</a>
<a class="sourceLine" id="cb45-8" title="8">m=<span class="dv">200</span></a>
<a class="sourceLine" id="cb45-9" title="9">n=<span class="dv">50</span></a>
<a class="sourceLine" id="cb45-10" title="10"><span class="co">#m: number of replicates; n: sample size</span></a>
<a class="sourceLine" id="cb45-11" title="11">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.06</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb45-12" title="12">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb45-13" title="13">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb45-14" title="14"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb45-15" title="15">  e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb45-16" title="16">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb45-17" title="17">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb45-18" title="18">    index=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb45-19" title="19">    mydata&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-20" title="20">    <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb45-21" title="21">      <span class="cf">if</span>(index[t]<span class="op">==</span><span class="dv">1</span>) mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu1,sigma1) </a>
<a class="sourceLine" id="cb45-22" title="22">      <span class="cf">else</span> mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu2,sigma2)</a>
<a class="sourceLine" id="cb45-23" title="23">    }</a>
<a class="sourceLine" id="cb45-24" title="24">    sktests[i] &lt;-<span class="st"> </span><span class="kw">Mardia</span>(mydata)</a>
<a class="sourceLine" id="cb45-25" title="25">  }</a>
<a class="sourceLine" id="cb45-26" title="26">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb45-27" title="27">}</a>
<a class="sourceLine" id="cb45-28" title="28"><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb45-29" title="29">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb45-30" title="30"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-31" title="31">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb45-32" title="32"><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-33" title="33"><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span> the distribution is multinormal, when <span class="math inline">\(0\leq \epsilon \leq 1\)</span> the empirical power of the test is greater than 0.05 and highest(close to 1) when <span class="math inline">\(0.1\leq \epsilon \leq 0.3\)</span>.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ol style="list-style-type: decimal">
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p></li>
<li><p>What information is needed to test your hypothesis?</p></li>
</ol>
<p><span class="math inline">\(\textbf{Solve:}\)</span></p>
<ol style="list-style-type: decimal">
<li><p>Denote the powers of two methods as <span class="math inline">\(pwr_{1}\)</span> and <span class="math inline">\(pwr_{2}\)</span>, then the corresponding hypothesis test problem is: <span class="math display">\[H_{0}: pwr_{1}=pwr_{2} \leftrightarrow H_{1}: pwr_{1}\not=pwr_{2}.\]</span></p></li>
<li><p>As the p-value of two methods for the same sample is not independent, we can not apply the two-sample t-test. For the z-test and paired-t test, when the sample size is large, we have the mean value of significance test follows a normal distribution, thus these two methods can be used in the approximate level. McNemar test is good at dealing with this case as it doesn’t need to know the distribution.</p></li>
<li><p>For these test, what we already know is the number of experiments and the value of power(the probability that we reject the null hypothesis correctly). To conduct this test, we also need to know the significance of both methods for each sample.</p></li>
</ol>
</div>
<div id="section-4" class="section level2">
<h2>11-03</h2>
</div>
<div id="exercise-7.1" class="section level2">
<h2>Exercise 7.1</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Compute a Jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span> We conduct Jackknife estimate as follows:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">library</span>(bootstrap) <span class="co">#for the law data</span></a>
<a class="sourceLine" id="cb46-2" title="2">theta_hat&lt;-<span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</a>
<a class="sourceLine" id="cb46-3" title="3">n&lt;-<span class="kw">nrow</span>(law)</a>
<a class="sourceLine" id="cb46-4" title="4">theta_jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb46-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb46-6" title="6">  x&lt;-law[<span class="op">-</span>i,]</a>
<a class="sourceLine" id="cb46-7" title="7">  theta_jack[i]&lt;-<span class="kw">cor</span>(x<span class="op">$</span>LSAT, x<span class="op">$</span>GPA)</a>
<a class="sourceLine" id="cb46-8" title="8">}</a>
<a class="sourceLine" id="cb46-9" title="9"></a>
<a class="sourceLine" id="cb46-10" title="10">bias_jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta_jack)<span class="op">-</span>theta_hat)</a>
<a class="sourceLine" id="cb46-11" title="11">se_jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta_jack<span class="op">-</span>theta_hat)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb46-12" title="12"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta_hat,<span class="dt">bias.jack=</span>bias_jack,<span class="dt">se.jack=</span>se_jack),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.776    -0.006     0.143</code></pre>
</div>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span> We conduct Bootstrap estimate as follows:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">library</span>(boot) <span class="co">#for the law data</span></a>
<a class="sourceLine" id="cb48-2" title="2">B=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb48-4" title="4">theta_boot &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb48-5" title="5">thetaboot &lt;-<span class="st"> </span><span class="cf">function</span>(data, index) {</a>
<a class="sourceLine" id="cb48-6" title="6">  <span class="co">#function to compute the statistic</span></a>
<a class="sourceLine" id="cb48-7" title="7">  <span class="kw">mean</span>(data[index]) </a>
<a class="sourceLine" id="cb48-8" title="8">}</a>
<a class="sourceLine" id="cb48-9" title="9">air=aircondit[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb48-10" title="10">boot.result &lt;-<span class="st"> </span><span class="kw">boot</span>(air, <span class="dt">statistic =</span> thetaboot, <span class="dt">R =</span> B)</a></code></pre></div>
<p>We print the result of Bootstrap:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">print</span>(boot.result)</a></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = air, statistic = thetaboot, R = B)
## 
## 
## Bootstrap Statistics :
##     original     bias    std. error
## t1* 108.0833 0.02541667    37.84966</code></pre>
<p>Compute 95% bootstrap confidence intervals for the mean time between failures by the standard normal, basic, percentile, and BCa methods:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">boot.ci</span>(<span class="dt">boot.out =</span> boot.result, <span class="dt">conf =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.result, conf = 0.95, type = c(&quot;norm&quot;, 
##     &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.9, 182.2 )   ( 23.2, 168.5 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.7, 193.0 )   ( 57.4, 211.1 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>The interval length of Basic and Percentile are nearly the same, while the length of BCa interval is the largest, which means it is the most conservative one. Besides, CIs of normal and basic method has <span class="math inline">\(\hat{\theta}\)</span> as their center.</p>
</div>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Refer to Exercise 7.7. Obtain the Jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span> Value of <span class="math inline">\(\hat{\theta}\)</span>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb53-2" title="2">n&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb53-3" title="3">lambda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb53-4" title="4">theta_hat &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat)</a>
<a class="sourceLine" id="cb53-5" title="5"><span class="kw">print</span>(theta_hat)</a></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<p>Estimated bias and sd of <span class="math inline">\(\hat{\theta}\)</span> using Jackknife:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co">#Jackknife</span></a>
<a class="sourceLine" id="cb55-2" title="2">theta_jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb55-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb55-4" title="4">  x&lt;-scor[<span class="op">-</span>i,]</a>
<a class="sourceLine" id="cb55-5" title="5">  lambda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb55-6" title="6">  theta_jack[i] &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat)</a>
<a class="sourceLine" id="cb55-7" title="7">}</a>
<a class="sourceLine" id="cb55-8" title="8">biasj&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta_jack)<span class="op">-</span>theta_hat)</a>
<a class="sourceLine" id="cb55-9" title="9">sej&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n)<span class="op">*</span><span class="kw">sd</span>(theta_jack)</a>
<a class="sourceLine" id="cb55-10" title="10"><span class="kw">print</span>(<span class="kw">c</span>(biasj, sej))</a></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
</div>
<div id="exercise-7.11" class="section level2">
<h2>Exercise 7.11</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb63-2" title="2">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb63-3" title="3">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-4" title="4"><span class="co"># for leave-two-out cross validation</span></a>
<a class="sourceLine" id="cb63-5" title="5"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb63-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(j<span class="dv">-1</span>)){</a>
<a class="sourceLine" id="cb63-7" title="7">    y &lt;-<span class="st"> </span>magnetic[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]</a>
<a class="sourceLine" id="cb63-8" title="8">    x &lt;-<span class="st"> </span>chemical[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]</a>
<a class="sourceLine" id="cb63-9" title="9">    <span class="co">#Linear model</span></a>
<a class="sourceLine" id="cb63-10" title="10">    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb63-11" title="11">    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]</a>
<a class="sourceLine" id="cb63-12" title="12">    yhat2 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]</a>
<a class="sourceLine" id="cb63-13" title="13">    a &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb63-14" title="14">    b &lt;-<span class="st"> </span>magnetic[j] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb63-15" title="15">    e1[(j<span class="dv">-1</span>)<span class="op">*</span>(j<span class="dv">-2</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>i] &lt;-<span class="st"> </span>(a<span class="op">*</span>a<span class="op">+</span>b<span class="op">*</span>b)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb63-16" title="16">    <span class="co">#Quadratic model</span></a>
<a class="sourceLine" id="cb63-17" title="17">    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb63-18" title="18">    yhat1 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb63-19" title="19">    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb63-20" title="20">    a &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb63-21" title="21">    b &lt;-<span class="st"> </span>magnetic[j] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb63-22" title="22">    e2[(j<span class="dv">-1</span>)<span class="op">*</span>(j<span class="dv">-2</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>i] &lt;-<span class="st"> </span>(a<span class="op">*</span>a<span class="op">+</span>b<span class="op">*</span>b)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb63-23" title="23">    <span class="co">#Exponential model</span></a>
<a class="sourceLine" id="cb63-24" title="24">    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span>x)</a>
<a class="sourceLine" id="cb63-25" title="25">    logyhat1 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]</a>
<a class="sourceLine" id="cb63-26" title="26">    logyhat2 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]</a>
<a class="sourceLine" id="cb63-27" title="27">    yhat1 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat1)</a>
<a class="sourceLine" id="cb63-28" title="28">    yhat2 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat2)</a>
<a class="sourceLine" id="cb63-29" title="29">    a &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb63-30" title="30">    b &lt;-<span class="st"> </span>magnetic[j] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb63-31" title="31">    e3[(j<span class="dv">-1</span>)<span class="op">*</span>(j<span class="dv">-2</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>i] &lt;-<span class="st"> </span>(a<span class="op">*</span>a<span class="op">+</span>b<span class="op">*</span>b)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb63-32" title="32">    <span class="co">#Log-Log model</span></a>
<a class="sourceLine" id="cb63-33" title="33">    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span><span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb63-34" title="34">    logyhat1 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i])</a>
<a class="sourceLine" id="cb63-35" title="35">    logyhat2 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j])</a>
<a class="sourceLine" id="cb63-36" title="36">    yhat1 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat1)</a>
<a class="sourceLine" id="cb63-37" title="37">    yhat2 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat2)</a>
<a class="sourceLine" id="cb63-38" title="38">    a &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb63-39" title="39">    b &lt;-<span class="st"> </span>magnetic[j] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb63-40" title="40">    e4[(j<span class="dv">-1</span>)<span class="op">*</span>(j<span class="dv">-2</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>i] &lt;-<span class="st"> </span>(a<span class="op">*</span>a<span class="op">+</span>b<span class="op">*</span>b)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb63-41" title="41">  }</a>
<a class="sourceLine" id="cb63-42" title="42">}</a>
<a class="sourceLine" id="cb63-43" title="43"><span class="kw">c</span>(<span class="kw">mean</span>(e1), <span class="kw">mean</span>(e2), <span class="kw">mean</span>(e3), <span class="kw">mean</span>(e4))</a></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>Thus leave-two-out cross validation also recognizes the quadratic model as the best fit for the data.</p>
</div>
<div id="section-5" class="section level2">
<h2>11-10</h2>
</div>
<div id="exercise-8.3" class="section level2">
<h2>Exercise 8.3</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span></p>
<p>We fisrt compare the type one error rate of count five and permutation test applied count five. In the permutation test applied count five we fisrt count the numerb of extreme values of the original data, and then apply the permutations and select the tests which have more extreme values than the original data has. The probability of this kind of extreme permutation occur is regard as the p-value for this data.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb65-2" title="2">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb65-3" title="3">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb65-4" title="4">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb65-5" title="5">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb65-6" title="6">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb65-7" title="7">  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb65-8" title="8">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb65-9" title="9">}</a>
<a class="sourceLine" id="cb65-10" title="10">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb65-11" title="11">n2 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb65-12" title="12">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb65-13" title="13">sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb65-14" title="14">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb65-15" title="15">tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb65-16" title="16">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb65-17" title="17">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb65-18" title="18">  x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></a>
<a class="sourceLine" id="cb65-19" title="19">  y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb65-20" title="20">  <span class="kw">count5test</span>(x, y)</a>
<a class="sourceLine" id="cb65-21" title="21">} )</a>
<a class="sourceLine" id="cb65-22" title="22">alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(tests)</a>
<a class="sourceLine" id="cb65-23" title="23"><span class="kw">print</span>(alphahat)</a></code></pre></div>
<pre><code>## [1] 0.104</code></pre>
<p>The result suggests that for unequal sample sizes, the count five criterion dosen’t control the t1e.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">library</span>(RANN)</a>
<a class="sourceLine" id="cb67-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb67-3" title="3"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb67-4" title="4"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb67-5" title="5"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb67-6" title="6"></a>
<a class="sourceLine" id="cb67-7" title="7">maxoutp&lt;-<span class="cf">function</span>(x,ix,sizes){</a>
<a class="sourceLine" id="cb67-8" title="8">  data&lt;-x[ix]</a>
<a class="sourceLine" id="cb67-9" title="9">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb67-10" title="10">  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb67-11" title="11">  data1&lt;-data[<span class="dv">1</span><span class="op">:</span>n1]</a>
<a class="sourceLine" id="cb67-12" title="12">  data2&lt;-data[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(n1<span class="op">+</span>n2)]</a>
<a class="sourceLine" id="cb67-13" title="13">  X&lt;-data1<span class="op">-</span><span class="kw">mean</span>(data1)</a>
<a class="sourceLine" id="cb67-14" title="14">  Y&lt;-data2<span class="op">-</span><span class="kw">mean</span>(data2)</a>
<a class="sourceLine" id="cb67-15" title="15">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb67-16" title="16">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb67-17" title="17">  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb67-18" title="18">}</a>
<a class="sourceLine" id="cb67-19" title="19"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb67-20" title="20">m=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb67-21" title="21">sizes=<span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb67-22" title="22">testp&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb67-23" title="23"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb67-24" title="24">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb67-25" title="25">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb67-26" title="26">  data&lt;-<span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb67-27" title="27">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> data, <span class="dt">statistic =</span> maxoutp, <span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>, <span class="dt">R=</span><span class="dv">999</span>, <span class="dt">sizes=</span>sizes)</a>
<a class="sourceLine" id="cb67-28" title="28">  e &lt;-<span class="st"> </span>boot.obj<span class="op">$</span>t0</a>
<a class="sourceLine" id="cb67-29" title="29">  E &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t, e)</a>
<a class="sourceLine" id="cb67-30" title="30">  a=<span class="kw">mean</span>(E <span class="op">&gt;</span><span class="st"> </span>e)</a>
<a class="sourceLine" id="cb67-31" title="31">  testp[i]&lt;-<span class="kw">as.integer</span>(a<span class="op">&gt;</span><span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb67-32" title="32">}</a>
<a class="sourceLine" id="cb67-33" title="33"><span class="kw">mean</span>(testp)</a></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<p>Thus after applying the permutation test, the t1e is controlled at a low level. Although there still exist some problems. This fisrt is about the existence of ties, which is contradictory to the assumption of continuity for permutation test.</p>
</div>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span></p>
<ol style="list-style-type: decimal">
<li>We use the following code to help conduct NN method:</li>
</ol>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">library</span>(RANN)</a>
<a class="sourceLine" id="cb69-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb69-3" title="3"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb69-4" title="4"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb69-5" title="5"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb69-6" title="6"></a>
<a class="sourceLine" id="cb69-7" title="7">Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</a>
<a class="sourceLine" id="cb69-8" title="8">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb69-9" title="9">  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb69-10" title="10">  z &lt;-<span class="st"> </span>z[ix, ];</a>
<a class="sourceLine" id="cb69-11" title="11">  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb69-12" title="12">  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb69-13" title="13">  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb69-14" title="14">  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</a>
<a class="sourceLine" id="cb69-15" title="15">  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb69-16" title="16">}</a>
<a class="sourceLine" id="cb69-17" title="17"></a>
<a class="sourceLine" id="cb69-18" title="18">eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</a>
<a class="sourceLine" id="cb69-19" title="19">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb69-20" title="20">  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb69-21" title="21">  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb69-22" title="22">  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</a>
<a class="sourceLine" id="cb69-23" title="23">}</a></code></pre></div>
<p>Unequal variances and equal expectations: We generate variables from two distributions <span class="math inline">\(N(\mu_{1},\Sigma_{1})\)</span> and <span class="math inline">\(N(\mu_{2},\Sigma_{2})\)</span> where: <span class="math display">\[\mu_{1}=\mu_{2}=(0,0,0)^{T}, \Sigma_{1}=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right)
\Sigma_{2}=\left( \begin{array}{ccc}
2 &amp; 0 &amp; 0 \\
0 &amp; 3 &amp; 0 \\
0 &amp; 0 &amp; 4 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb70-2" title="2">sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb70-3" title="3">mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb70-4" title="4">sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb70-5" title="5">n1=n2=<span class="dv">20</span></a>
<a class="sourceLine" id="cb70-6" title="6">n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </a>
<a class="sourceLine" id="cb70-7" title="7">N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb70-8" title="8">k=<span class="dv">3</span></a>
<a class="sourceLine" id="cb70-9" title="9">R=<span class="dv">999</span></a>
<a class="sourceLine" id="cb70-10" title="10">m=<span class="dv">100</span></a>
<a class="sourceLine" id="cb70-11" title="11"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb70-12" title="12">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb70-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb70-14" title="14">  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</a>
<a class="sourceLine" id="cb70-15" title="15">  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</a>
<a class="sourceLine" id="cb70-16" title="16">  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</a>
<a class="sourceLine" id="cb70-17" title="17">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb70-18" title="18">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb70-19" title="19">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb70-20" title="20">}</a>
<a class="sourceLine" id="cb70-21" title="21">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</a>
<a class="sourceLine" id="cb70-22" title="22">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb70-23" title="23">pow</a></code></pre></div>
<pre><code>## [1] 0.35 0.28 0.88</code></pre>
<p>From the result we can see that while the ball method shows a performance, both NN and energy method perform poorly. Besides, the power of NN method is slightly higher than the energy method.</p>
<ol start="2" style="list-style-type: decimal">
<li>Unequal variances and unequal expectations: We generate variables from two distributions <span class="math inline">\(N(\mu_{1},\Sigma_{1})\)</span> and <span class="math inline">\(N(\mu_{2},\Sigma_{2})\)</span> where: <span class="math display">\[\mu_{1}=(0,0,0)^{T}, \mu_{2}=(0.5,-0.5,0.5)^{T}, \Sigma_{1}=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right)
\Sigma_{2}=\left( \begin{array}{ccc}
2 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 \\
0 &amp; 0 &amp; 2 \end{array} \right).\]</span></li>
</ol>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb72-2" title="2">sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb72-3" title="3">mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb72-4" title="4">sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb72-5" title="5">n1=n2=<span class="dv">20</span></a>
<a class="sourceLine" id="cb72-6" title="6">n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </a>
<a class="sourceLine" id="cb72-7" title="7">N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb72-8" title="8">k=<span class="dv">3</span></a>
<a class="sourceLine" id="cb72-9" title="9">R=<span class="dv">999</span></a>
<a class="sourceLine" id="cb72-10" title="10">m=<span class="dv">100</span></a>
<a class="sourceLine" id="cb72-11" title="11"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb72-12" title="12">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb72-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb72-14" title="14">  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</a>
<a class="sourceLine" id="cb72-15" title="15">  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</a>
<a class="sourceLine" id="cb72-16" title="16">  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</a>
<a class="sourceLine" id="cb72-17" title="17">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb72-18" title="18">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb72-19" title="19">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb72-20" title="20">}</a>
<a class="sourceLine" id="cb72-21" title="21">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</a>
<a class="sourceLine" id="cb72-22" title="22">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb72-23" title="23">pow</a></code></pre></div>
<pre><code>## [1] 0.33 0.58 0.76</code></pre>
<p>The result shows that the ball method is still the one performs the best, while the NN method is the worst one.</p>
<ol start="3" style="list-style-type: decimal">
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
</ol>
<p>We first generate variables from two distinct t distribution and use the three methods to test it:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">n1=n2=<span class="dv">20</span></a>
<a class="sourceLine" id="cb74-2" title="2">n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </a>
<a class="sourceLine" id="cb74-3" title="3">N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb74-4" title="4">k=<span class="dv">3</span></a>
<a class="sourceLine" id="cb74-5" title="5">R=<span class="dv">999</span></a>
<a class="sourceLine" id="cb74-6" title="6">m=<span class="dv">100</span></a>
<a class="sourceLine" id="cb74-7" title="7"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb74-8" title="8">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb74-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb74-10" title="10">  mydata1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rt</span>(n1,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb74-11" title="11">  mydata2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rt</span>(n2,<span class="dv">2</span>,<span class="dv">5</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb74-12" title="12">  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</a>
<a class="sourceLine" id="cb74-13" title="13">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb74-14" title="14">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb74-15" title="15">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb74-16" title="16">}</a>
<a class="sourceLine" id="cb74-17" title="17">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</a>
<a class="sourceLine" id="cb74-18" title="18">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb74-19" title="19">pow</a></code></pre></div>
<pre><code>## [1] 0.66 0.57 0.79</code></pre>
<p>The result suggests that for t distributions, the ball method still performs the best, followed by the NN method. In this case the difference between these methods is not so large.</p>
<p>We then generate variables from two distinct bimodel distributions: <span class="math inline">\(\frac{1}{2}N(0,1)+\frac{1}{2}N(0,2)\)</span> and <span class="math inline">\(\frac{1}{2}N(1,4)+\frac{1}{2}N(1,3)\)</span>, and use the three methods to test it:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">n1=n2=<span class="dv">20</span></a>
<a class="sourceLine" id="cb76-2" title="2">n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </a>
<a class="sourceLine" id="cb76-3" title="3">N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb76-4" title="4">k=<span class="dv">3</span></a>
<a class="sourceLine" id="cb76-5" title="5">R=<span class="dv">999</span></a>
<a class="sourceLine" id="cb76-6" title="6">m=<span class="dv">100</span></a>
<a class="sourceLine" id="cb76-7" title="7"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb76-8" title="8">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb76-9" title="9">rbimodel&lt;-<span class="cf">function</span>(n,mu1,mu2,sd1,sd2){</a>
<a class="sourceLine" id="cb76-10" title="10">  index=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb76-11" title="11">  x=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb76-12" title="12">  index1&lt;-<span class="kw">which</span>(index<span class="op">==</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb76-13" title="13">  x[index1]&lt;-<span class="kw">rnorm</span>(<span class="kw">length</span>(index1), mu1, sd1)</a>
<a class="sourceLine" id="cb76-14" title="14">  index2&lt;-<span class="kw">which</span>(index<span class="op">==</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb76-15" title="15">  x[index2]&lt;-<span class="kw">rnorm</span>(<span class="kw">length</span>(index2), mu2, sd2)</a>
<a class="sourceLine" id="cb76-16" title="16">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb76-17" title="17">}</a>
<a class="sourceLine" id="cb76-18" title="18"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb76-19" title="19">  mydata1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbimodel</span>(n1,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb76-20" title="20">  mydata2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbimodel</span>(n2,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb76-21" title="21">  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</a>
<a class="sourceLine" id="cb76-22" title="22">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb76-23" title="23">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb76-24" title="24">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb76-25" title="25">}</a>
<a class="sourceLine" id="cb76-26" title="26">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</a>
<a class="sourceLine" id="cb76-27" title="27">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb76-28" title="28">pow</a></code></pre></div>
<pre><code>## [1] 0.47 0.59 0.80</code></pre>
<p>The result suggests that for bimodel distributions, the energy method performs better thatn the NN method, while the power of ball method is much higher than the other two methods.</p>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples:</li>
</ol>
<p>In this case we consider the same distribution as (2), although the the number of two samples is unbalaned, where <span class="math inline">\(n_{1}=10, n_{2}=30\)</span>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb78-2" title="2">sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb78-3" title="3">mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb78-4" title="4">sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb78-5" title="5">n1=<span class="dv">10</span></a>
<a class="sourceLine" id="cb78-6" title="6">n2=<span class="dv">30</span></a>
<a class="sourceLine" id="cb78-7" title="7">n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </a>
<a class="sourceLine" id="cb78-8" title="8">N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb78-9" title="9">k=<span class="dv">3</span></a>
<a class="sourceLine" id="cb78-10" title="10">R=<span class="dv">999</span></a>
<a class="sourceLine" id="cb78-11" title="11">m=<span class="dv">100</span></a>
<a class="sourceLine" id="cb78-12" title="12"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb78-13" title="13">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb78-14" title="14"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb78-15" title="15">  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</a>
<a class="sourceLine" id="cb78-16" title="16">  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</a>
<a class="sourceLine" id="cb78-17" title="17">  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</a>
<a class="sourceLine" id="cb78-18" title="18">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb78-19" title="19">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb78-20" title="20">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb78-21" title="21">}</a>
<a class="sourceLine" id="cb78-22" title="22">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</a>
<a class="sourceLine" id="cb78-23" title="23">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb78-24" title="24">pow</a></code></pre></div>
<pre><code>## [1] 0.09 0.25 0.60</code></pre>
<p>The result suggest that while the NN and energy methods have a poor performance, the power of ball method still reaches 0.6.</p>
<p>To summarize, the ball method has a better performance over the other two methods in general.</p>
</div>
<div id="section-6" class="section level2">
<h2>11-17</h2>
</div>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> We use the proposal distribution <span class="math inline">\(N(0,\sigma^{2})\)</span> to generate the standard Laplace distribution when <span class="math inline">\(\sigma\)</span> is selected from (0.05,0.5,2,16):</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">f&lt;-<span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb80-2" title="2">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb80-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb80-4" title="4">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb80-5" title="5">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb80-6" title="6">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb80-7" title="7">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb80-8" title="8">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb80-9" title="9">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb80-10" title="10">      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb80-11" title="11">        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb80-12" title="12">        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb80-13" title="13">      }</a>
<a class="sourceLine" id="cb80-14" title="14">  }</a>
<a class="sourceLine" id="cb80-15" title="15">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb80-16" title="16">}</a>
<a class="sourceLine" id="cb80-17" title="17"><span class="kw">set.seed</span>(<span class="dv">2001</span>)</a>
<a class="sourceLine" id="cb80-18" title="18">N &lt;-<span class="st"> </span><span class="dv">3000</span></a>
<a class="sourceLine" id="cb80-19" title="19">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.3</span>, <span class="fl">1.5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb80-20" title="20">x0 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb80-21" title="21">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb80-22" title="22">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb80-23" title="23">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb80-24" title="24">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb80-25" title="25">index=<span class="dv">1</span><span class="op">:</span>N</a>
<a class="sourceLine" id="cb80-26" title="26"><span class="kw">plot</span>(index, rw1<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.05&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">plot</span>(index, rw2<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.3&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">plot</span>(index, rw3<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=1.5&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">plot</span>(index, rw4<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=10&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZjpmZmZmZrZmkLZmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2Zma2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb/9vb////tmb/25D/27b//7b//9v////7N+VaAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJxUlEQVR4nO3dDXfbthkF4FeZ3bh118xet34k2rrOytY2Sj8kx8L//2MlCIAECUIXlCASku49J4lMEiDxGASpE4gSxeyNzH0ApYdAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBzA+0W8rt5tDCK1t2915k8d3B1ezJWQNplrpsVYfO66wHZjI/0OH57WuxQGtZ/Kg+irzLv5PZgD7eVyfFVz83PUj3hpunlbz68PIor3+7l8Vb9fGuWqQ3rim+rF4+34nJ4qlSkcWdKbvUncf8nTtzAa1NO199sEDmJFncGyCTe7uF2jYoXaCbnwxuVeJBtQNS1swEpHvJRv0qVcMMUGXwerNbiQV60OvkrXast/hso20eOkAf32xs76tXaSCtmTkzAVVNuvnJvDSNNI2rbGqgaoH52zZdqd//fz8wCF8ukDmj/vLdxjbSXcrcGGT6mGv67t8yfJW6XCD16WtzpvzXNNJwRIC05s1/ftcL/FNMXTRQRfTDfX2Vxj3ItP8lDnSBg7TJ7l+Vx9AY1AXa1jc4wSCt2lsEdyG8nMt81ea/bfR55jpP9yoW9KDbzadlfAzSN4pvL+xG8X3TEYbug8IxaO8gfZFvNX7VI9CX3Tvpv/4cv4rd/LgOx+Dmfdzu/d3Fvlnt5CTj7FEpBagafd7UHeYUp8kxKQVo27k6FZRSgNSnf9zZt/dlpRigUkMgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBZAaSs8lcQHmrO10IBHIiIDdbMDof+cqB1vZzAWrrXkSqK9/pJEC7ZcOyjkwlvG6gl8dmHvI2cpJdNxB7EMraTWXnGBSJ+zBgdDLztQMlVpd+nzpbJgbq3cETCFVHIFDdlQI1n9eOv9m4bqDqRgh9KPTKgSoh8GGcaweq7hD3f+rx6oESqyMQqI5AoDoCgeoIBKojEKiOQKA6AoHqCASqIxCojkCgOgKB6ggEqiMQqI5AoDoCgeoIBKojEKiOQKA6AoHqCASqIxCojkCgOgKB6q4U6OVRzyvbJkwDLggoMhXndEBr83ziyH+wEsjSFDaJc8/+pgZ6vquBetOA+58RmQpIev8ObXKBPSgsHauvOCDdR14rN1zHq7tSIFUbLZ7i06SzAkmwJLZlQUCJ1RUFNLiyMKCkecHSe1Eq0P+O+W6KKYFkQqCXb93Pz3dHfXnHwUBSONCjfRL4sV9uMgWQpzLdKWa+tOP4R8oXCBTtfmlpNtzK4p/HP1F+AiCZCSjPN79cMNBa96Cjv13pYoGab0OJ3SKPq67fhrMHyn8VE/ejfpHwJIghIFG9Jd3FkwJlvw8S9/fJgGQQKNhRvkHaJc+d9CxAMgnQUZkUSM4aSFKA2gZCoHYtgTwBt0RiQOaniwPqD677geraxB973OoxQNJbPK5FudIFsuNo+MCnAEjGAkkXSFzBQKO3Sf8IUluUK16TxDV74IlYMwF5w1YxQBIF6lymk4Fse+3/MY0Fip1wuEW5cgIgOQBIpFnYbiLi98ORLcqVJCA5Fqj5X8pEoIb0jIDcGGKXpAJ5Oq7FZlOrIx0gUecDJJ2NWiK7JAYkAoG83tgDUucO5N/SdICkWYqB2tNVukBSNJA7Gv8fbyP7s/1Fd4FkBJASd8cVA/JKdjptkUDt0fs9SJrNXRXjgDykAEimBkp90GR/mNgDJBCo10yvTu+a7wM1PyvvtJoEKPlBk8prRTqQO9Oa3/8QkF91eEq50XkeoPTHBA4A+a2RIaD2l98rlwwkHpDXq9RkQPEHTXptCYD8Znots2OPv1EIEAKpOJDf69ydQx/IuxScAOiwHuQ1s2EZCSRRIG93HmMI1LidFCj9QZMDrVQxoLb/qeaX7Q/Gqm26SByoKdcDUs3oNAFQ8oMm04EkCuT9SQZyyxxQ92AmAEquriWJAUnbCAykUoGUSGeRdzDnAdSMpsoHan/3LVC7xeUCKQ/IGxTaXfpAqgVS/rXb1dsFUiOBprmKjaguCqQGgNShQL2KokCqaCDVNCUAUgGQigFJIpB3BN2DOgegcHdeBwla1Afyr3kxIHXlQOqqgVQKkPKB/HowkCoNyB7VXqB28RCQ6gI1biGQGgHUVj6qRZlCoMTqvKvt/EDtLlShQHB3GYE6S/q76FaelJMDqQOAwgpDoAEOANR5cXVAnZ0GP6iigVQKEDgUT9C9e1UBULdEDGjvgUQOLV8OBEpYJ93fPYH6644FGrGzwzY8sLoRQLDe3uhxkUAZKt83lvtLCLR3v2cFdOJdDC8kEFh4LkD5Q6A8+yXQcfu9NqDRIRAIgUAIBDIb0NlkJiBYaXzV/GtybH50pfMzEOjgNTk2P7rS+RkIdPCaHJsfXen8DAQ6eE2OzY+udH4GAh28Jsfm1xcCgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCyQ+0ldTHUj9/8aFTIHzRS/1kjIdxZdQ6vmnKoWYH2urv3UgSenmsn07QFAhf9LJbVgvX+rHF6WXUutpJZNOkQ80NZB4+sEp4dPfWPCOlKRC+6Md8r1DV4hFl6u+Q2S2HNk071NxATSPQhlt5qJ9v0RQIX0QKLp7GltFAo/djkx3oc91lt0nPXDZArkD4YrjUamjT/WXW1Xk0ej82uYHMOZ02CNXH1hQIXwwXqkbpcWW29cA+dj8u5wa0dWP0mMbulrebUoBOfIqZp6qMPl30uFXIKZY8SCsHNGbwtI/AGj3gVqtLGaTTL/MWaMzl1z2eZ/StwXbUrUEnM94o2t6dfgP3fOeeWjTipm91uzEUhdwoerf2MPb0bwqEL4KadfSq5DL6mzDEdLwRZbzwzSoIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBFIckPcdXTaJUyFOlOKAwhAIhECd6FPs5fH7RzNnRU9Q+cHOd9Gzy/R8sHrq82QpFEhPqa/+rPQ0ebE/6PlTeipU7NvxTpNCgR68eYWrxZPpNHrC1fbVL3+f9IwrFOhd/aKZo2eGodprJUnzH7OlaKB1A2SfzPZOTwTu3wacNkUD9XqQzm75TdIU42wpGsjOZNZjkOs269s/llNexMoGqi9ezVXMjNbvEqfx50rZQN37oArGzHqecpguDqi0EAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgkD8B1xw3vxlWM6gAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</a></code></pre></div>
<pre><code>## [1]   69  319 1200 2568</code></pre>
<p>We calculate the acceptance rates of each chain:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N))</a></code></pre></div>
<pre><code>## [1] 0.9770000 0.8936667 0.6000000 0.1440000</code></pre>
<p>Only the third chain has a rejection rate in the range [0.15, 0.5]. Thus we choose <span class="math inline">\(\sigma=1.5\)</span> and compare the result with the true distribution:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">y&lt;-rw3<span class="op">$</span>x[<span class="dv">501</span><span class="op">:</span>N]</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">hist</span>(y, <span class="dt">breaks=</span><span class="dv">50</span>, <span class="dt">main=</span><span class="st">&quot;Laplace distribution&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb88-3" title="3">a&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb88-4" title="4"><span class="kw">lines</span>(a, <span class="kw">f</span>(a))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-2" class="section level2">
<h2>Exercise 2</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> We fisrt consider the case when <span class="math inline">\(\sigma=0.3\)</span>:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</a>
<a class="sourceLine" id="cb89-2" title="2">  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></a>
<a class="sourceLine" id="cb89-3" title="3">  <span class="co"># for chain in i-th row of X</span></a>
<a class="sourceLine" id="cb89-4" title="4">  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</a>
<a class="sourceLine" id="cb89-5" title="5">  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</a>
<a class="sourceLine" id="cb89-6" title="6">  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</a>
<a class="sourceLine" id="cb89-7" title="7">  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></a>
<a class="sourceLine" id="cb89-8" title="8">  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></a>
<a class="sourceLine" id="cb89-9" title="9">  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></a>
<a class="sourceLine" id="cb89-10" title="10">  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></a>
<a class="sourceLine" id="cb89-11" title="11">  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></a>
<a class="sourceLine" id="cb89-12" title="12">  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></a>
<a class="sourceLine" id="cb89-13" title="13">  <span class="kw">return</span>(r.hat)</a>
<a class="sourceLine" id="cb89-14" title="14">}</a>
<a class="sourceLine" id="cb89-15" title="15"><span class="kw">set.seed</span>(<span class="dv">2001</span>)</a>
<a class="sourceLine" id="cb89-16" title="16">sigma &lt;-<span class="st"> </span><span class="fl">0.3</span> <span class="co">#parameter of proposal distribution</span></a>
<a class="sourceLine" id="cb89-17" title="17">k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></a>
<a class="sourceLine" id="cb89-18" title="18">n &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#length of chains</span></a>
<a class="sourceLine" id="cb89-19" title="19">b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></a>
<a class="sourceLine" id="cb89-20" title="20"><span class="co">#choose overdispersed initial values</span></a>
<a class="sourceLine" id="cb89-21" title="21">x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb89-22" title="22"><span class="co">#generate the chains</span></a>
<a class="sourceLine" id="cb89-23" title="23">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb89-24" title="24"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb89-25" title="25">  X[i, ] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma, x0[i], n)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb89-26" title="26"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb89-27" title="27">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb89-28" title="28"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</a>
<a class="sourceLine" id="cb89-29" title="29">  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb89-30" title="30"><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</a></code></pre></div>
<pre><code>## [1] 1.144707</code></pre>
<p>When the length of chain is set at 10000, we can see that we have <span class="math inline">\(\hat{R}&lt;1.2\)</span>. But it’s not the smallest length we need.</p>
<p>We also plot the psi for the four chains:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb91-3" title="3">  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&#39;sigma=0.3, X[0]=&#39;</span>, x0[i]), <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We then plot the sequence of R-hat statistics:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="co">#plot the sequence of R-hat statistics</span></a>
<a class="sourceLine" id="cb92-3" title="3">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb92-4" title="4"><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</a>
<a class="sourceLine" id="cb92-5" title="5">  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb92-6" title="6"><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;length-1000&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>, <span class="dt">main=</span><span class="st">&quot;R-hat statistics&quot;</span>)</a>
<a class="sourceLine" id="cb92-7" title="7"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We repeat the experiment when <span class="math inline">\(\sigma=0.5\)</span>:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2001</span>)</a>
<a class="sourceLine" id="cb93-2" title="2">sigma &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="co">#parameter of proposal distribution</span></a>
<a class="sourceLine" id="cb93-3" title="3">k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></a>
<a class="sourceLine" id="cb93-4" title="4">n &lt;-<span class="st"> </span><span class="dv">8000</span> <span class="co">#length of chains</span></a>
<a class="sourceLine" id="cb93-5" title="5">b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></a>
<a class="sourceLine" id="cb93-6" title="6"><span class="co">#choose overdispersed initial values</span></a>
<a class="sourceLine" id="cb93-7" title="7">x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb93-8" title="8"><span class="co">#generate the chains</span></a>
<a class="sourceLine" id="cb93-9" title="9">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb93-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb93-11" title="11">  X[i, ] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma, x0[i], n)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb93-12" title="12"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb93-13" title="13">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb93-14" title="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</a>
<a class="sourceLine" id="cb93-15" title="15">  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb93-16" title="16"><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</a></code></pre></div>
<pre><code>## [1] 1.146156</code></pre>
<p>When the length of chain is set at 8000, we can see that we have <span class="math inline">\(\hat{R}&lt;1.2\)</span>. But it’s not the smallest length we need.</p>
<p>We also plot the psi for the four chains:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb95-3" title="3">  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&#39;sigma=0.5, X[0]=&#39;</span>, x0[i]), <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmZjpmZmZmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQZpCQkGaQkLaQtraQttuQtv+Q2/+2ZgC2Zjq2kGa2tpC229u22/+2///bkDrbkGbbtmbbtpDb27bb2//b////tmb/25D/27b//7b//9v///+i2UauAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJqElEQVR4nO2d7WLTNhhGFdYu2QoMlsLGWEf3wRo2SgosSRvf/31Ntizb8dcjxZKl1M/5UZzEfiWdSK9lxzYiIb2I0BWIHQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjgQdD+SpxvjtvygxCzN+W2a5Exr6yyW4gnn/S/siSRlqW306+7WeUf10vqJiZBWfuqPlZNQam0uVr1Vy2k2A4JSrVkHzdK6iamIbYWs/fJXdpyxcOlWDZWUmpKTbLFxXZA0JdX+uN6ST24E3R3IXvti9uiB6Vf19nNSo4E2dD5lwsxe5vcLeRbRV2f3WRDRTG7kdupRusvVn7W0oJ0cP2rBpoqqbpd9k4lZnVDKXW2UFWrl9SDM0F5vpD1LqqdVvFCCVJc5Gsk26IBlcbkHWZV9AG51lOp8ba1pFSdKqm6Xb+gs4/qu2uU1IMrQWkv2SSfhSxZVVu2br7Zr0QuaJl+Jt6mrcvW+HaTullWBWWv02pnWTgpUtBhM7OiylRynsfJt+sTdPdyk3fuRkk9uBIkyzz7qBZVLVTpsjGZIPVFl61Jkq//XNSyZL3a++vF2W3yZdH4nre66R2CumsZUJAaUd+82eS10DXVOUj1MV23/XXL/qmj2ut6F8qKWuZLJoLqXS6IoOT+lerVf6taKB0dgtImnv35NX2jb4gptnVB62L0GA6xOARJRX9c6GkJ6EGqgg81QR2psy5Irjb7Sei9kUmSbggKkaQV+3dqftvIQYeCttlOqJ6kqzvtlN3rRdv3LFP3Mu2Cy8puvrqz70zSSTkDqZXUhytBss0/btJxpjvP4V6s0YPON/dX9ansOpsq5VPkLI6czn1eqClyZd+vhpVsff52uZ1hkq5ugXDWgz4UX1rbPKiZg1rm+uUBQJFchBocZbvTAXaTNbEcx5UDB0NBQQ41PqcZ6NnhTPr5bfde7Oz9up4k9x8W6hAyD3H/Wip+uam2e5U3KxtkRXv1dqaCKlsgfB+LGSVCkzht33ZTx/FnErrwJkh+1S+zDmPSjyG7RVu6qB+c4tMd9ngTtO3akxzD/vqX1rdPWZBMIIv88N4bpy3okUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCOBYkToZQgtyG8wcFAUYWZN9zQxNvD4pEIQUBohUUyyiMV1C6SgSSYhUkKAh+LqIYZjELUr0oMBELSiio52MtKLghT4LSm/2yewLWHffqIUH6zyMVtJ7dJA+X6c0XQwRlC6ENeRG0v1pmf883gwUF70JeBD1cqltuVueb4YICG/LYg5L05q3BgkJ3IU85KNeS3ap7TLjHLkjuxdQg219RkJdyKchCUFhDvgUNT9KBu1Ck56QnK8gwnOh8MTqnIShgHvIkSD9TovOxMhMXtNZPpdu2PJ7OIFxTUDBDfg81pKqOu9MtBak/IfB6sCrZot18a99oERTq19jgPchQULDTi75yUN6FcA5qa7VoEWRdB0d42ovpR0Z2Ph+jX9Dhq2JwhehCwedBWFC5Sog0FFpQ7ZcdIaofNoseX1F0gkTvDn3qgvJdVV9ZYxuKTFBSzckdW45rKEpBo9YEEF5Q4/QqKmnygkauiavSKMjVinbhjhE0qqGoBBk2PdvPjaVpZEGNk/aHgqyiOKkQLsv5inbhqoLs2jw9QZadQl+E5pmoBNmHmJYg2xCj3Bdz0oLUX7+GTlhQI5YXbAXtf3fzkGGngnwashX0cDn74ee//nNWrgtBXruQ9RC7v34qsoesuyn38QnKuP+t49cc63LdCPKYqI9M0rvn/anI+OIFJ4K8pKE8pH0OKqYfPf8hkPnFC6WgYW10fPhazq+89CCLn54rgkxr0o7TYVYJdZyg/ao3B1lcvCBUbRzc+eSyC9meoqquqPZiL3pTkF0PStwISgZ3wtZAx82D0P+BYX7xQiHIxdcfgyDDmbTxxQtuBbkaZEOGmCMOBTnbBz1aQa7DuoviWxC60n7ygupRWk7aU1BfOMeC3ER69IKGpvwRBNkcrDq9KkoJGjhr8C/I6mDV7VGmnlJFLcj2UMPHYXjUguwOVt2ezCkuGR4So2PZeCNEwB5UFjAg6Bg5yPJg1QMNQ8aJW/gXZHyw6sdNHlvUX5sK6nxhvNVwRhBUC25+ymlSgvSZZXCBemO79hfGWw1nFEHlYZ/WZLbZwSvj0myqZhzOq6A861T6jpmgnlfGmw1mFEG6rMr9VAYFTk+Q5f1UExRULReVWHc4NUG1XVTLbLJvfePAw4lBUNvl1o0KTVrQ4Z/6xx1vGAQeQP2cdCBBIv+5O9EnkLorNL0eJPI7Gco5dvG3LYdPTpAuX9SXOg5GpiqojdYz2RQEoCAABQEoCEBBAE+CTB+4PVVBxg/cnqgg8wduT1SQ+QO3JyrI/IHbExVk/sDtqQoyfuD2ZAWZhqMgEI6CmKSHlUtBIBwF1aMEP2lviydBhpcBh/5/aQzwNFEc+MDtiPB7qHHsA7cjwuvBamLwwO3YYQ8C+MpB8DLgk8GLIHwZcG/Q9rcdrOyivC68jImJC6qkIrugFASCUhAISkEgKAWBoFMRdHRQCgJBKegxQkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggDuBW2FmN10f5z9vL88WLG50I/6bWU+JIQ5zgVtZf223XXcX8nP1mnrihWbC4Dddze1sqxDmONakDrduJp3fb5bpL89rp98KlZsLiD0794DQpjjWlAhoHct+SUXKzYXUBnrea0s+xDmOBeUdf+uaxs0K9kWvWJzAZWxeqrS2IAQ5rgWpBIASAPpT/vFis0FUMTDZfrL92pICAtCCNrqHD2kdbKbnKQgg06uLg0ZOj5kujnJIYbTZH4d39AMK12cZJKGO9rydo9j99HKwnbQTMGcsSeKu8WyvqL1LC8TkP4PF6c4Uczua+2p4VpdgZWuUazYXACshL519ugQxvBgFUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCnICg3fcOr2axJn5BD5cuL/exJnpB255Hyo1B7IK2Yun0ijprYheUOL7k0BoKAlAQgIIAFASgIAAFASgIcAKCwkJBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+B5b9Jn4bRaHPAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmZjpmZmZmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQZpCQkGaQkLaQtraQttuQtv+Q2/+2ZgC2Zjq2kGa2tpC229u22/+2///bkDrbkGbbtmbbtpDb27bb2//b////tmb/25D/27b//7b//9v///85s4KmAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJh0lEQVR4nO2da2ObNhiFlS1dvLRdO6fdpc2WXbq421J6WZzE/P8fNoEQYJB0JBBGxOf5kBBHvJIe62qwLXLiRMxdgNShIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAFMJ2l2KJ7fDznwvxMlPzbmZKDlrJblbia8+6N8yJ1Hkpc/Tf1swhHOSnKCyfu0KbAw1ysq/i6RvtZD6PCDIFM5Fcl0sEyfv8o9FzRUPF2LdS6TUNJqkkPo8tyBjOBeRBX08l+38xU3dgop2f3q9kT1Bluzs87k4eZN/XMmHisSfX8mqPLsuu4ri5Fqepyqtn2L5v7f9fIrO9Y/qaCqn9nnlI62YnRMN4RzEFVR1cFnuuthFEc+VIMV5lSLf1hVoVaZ6hjd1G5CpnkqNN8acirqqnNrnuQRZwtmJKqhoJbf5JyHLqooti3N2u9uIStC6+J94U9SuTPHNbeFm3RZU/l1UtByF83rM2K9mmVXVkVRO7fNcgizh7EQVJAt1+q86VMVW9ZSVKQWpJ7qpTZ5/+fu8M152Be2uVqc3+edVb1TZ6lpaBJlLaA1nJaog1aO+LubospC6pHoMUm1MW9hdGSaUXgtSZN3nvMxqXR35CGqanCmcnbhj0P0r1YD/UoVUOiyCiiqe/vGleMDVxRTbbo2yuqN4drE9Qb1wdmJP8/e/n+tlCWhBqkoPHUG9QdpcI5ns5AdVYc9BOhVBkt2van3bG4P2BW3LSag7SLcn7YK71ytTi5Jj7bpoguvWNN+e7G2DtCWcg6iCZJ2/vy36mW48+7NYrwU9ub2/7C5qs3KpVC2RyzhyAfhppZbIrblfdStZ++rh5jznIN2E8yRuC3pfP2mmdVB/DDKs+putRj24CNU5mnoXHaxoF5lo+nFri+La5jThPIncxT4VI9Cz/ZX08xv7LHb6Luu29t37ldqsViHuX0vFL2/b9d5UVstOph+uz3PvA+twnhxkL9YdcgfHMXWMvo7hryQYmFaQfKpflg3Gu8u7uFuZtlHdzSnYzYcyraCtcbk/kN3Vz8aHlyxI9vhVtb2fjGULWj4UBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQGRBYjHMJShuuOmgIAAFAeYXlLiq2QX5j4LzkICgtBVREICCABQEoCAABQEoCDC/oDxtQwkISnsxTUEACgJQEICCABQEoCAABQEoCHBgQf2rKRQEwlEQCEdBIBwFgXAUBMJREAhHQSAcBYFwXUGpyUpHkHqkXEGm9BpseoKE+pGKo7kFNW5EdSjUj1RaUTKCBAUZw9VWRKVJuaEghyChfyRBEoKqNpPrzlYeJKIoFUGCgszhbIImyHIYKQqaKEt7WVwZJSKonNxFJ5eDCEK3008iqP5YeiFsn6ZrFNQp6WEE5d3npft/70AB7C7RpwwbBPXa+iEE6eWpPYF3pKB8d5fgM0eTEZQbMh5UiMDSbsG3UnQFqV8HF6RzPLwg33CuQecQgvRva15JCZo2S2cWFGTOQfSPhhZiYGkzr2keZDmZKWE8tCXxirX7bdTnC/euzfsImmxXJiYQ9HBx8t2Pf/43olT7+XoJmqoJtcPW89nQmUInvL96KsrPVx9HoKBpDJmm0NGCSu5/AV9Opr/qwbqgDhU0iSGDoF5OAwfpu+fOoSjT3+62tX3NW5igicbpfUFqOzh4tVqPQWgbmhftp9aSWT40PljQFIY6KqrJY78RTdKCHi7qfcZ2/DTf3k/G1dTtTaZpc5ig3cY5BkVqQXtSJhDktUUdOIu9cK+GMr1VHTUG9dXEGqzxixzhi9S9dRD8+gs9VFm/tiJckBqqxwuqhhpwYWmwoJEr6V4BBgka047qgdgdo06Q8ma1/2JRDEF1sJD0MROGhfMXlFfXpMeNRMGnLklQddmjakqDChR+1oIEVWvd3GsMMQQTg/rmkgSpv6p70AYIGjQHLk9Q9StUkBi45V2coOafYSUaWv7lCgor0eCJL31B419OD0486MRpBIHlrDNJSImGr5yWLegApX9MghyXR49WkGhP+PaFzui9W8yEQeHQltqVpBGkN97W5eNxCqo2ZPoG2dz0kvt+bkNIWlDuJ0iPMZYeOe6y2qIF1Rex24Ja6ZuGNZwDC+pemx8lKG+2V62YTXr99o8lCeqGGyeonbLvXE9q40r+WAT1Ijev/zxqQSGr5U5k3XpGXilKW1DQdmIvcj3+jC148oIGvMre7lejLzWmLyg4shjSMR0liJ0wKBwUNKgBxHw7XuKChkaPF5eCUKjoCYPCTSQoYtxHKigeFASgIAAFASgIQEEACgJMIsj/Xc9HKsj/Xc/HKsj7Xc9HK8j3Xc/HK8gzHAWBcBQEwlEQeNczBYFwFATCUVA3yv61+TQ+pszJZAtFz3c9J880gvzf9Zw8kwgKeM9q8ky0m/d+13PyzNaCFsMUgjze9ewMan44QuIY+dkISw7f9ewMegSCxgU9FkGtoSgsKAWBoBQEglIQCEpBIOixCBoclIIeIxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgQX9BWiJNr+7/Lq9frvYT9Azfq0sHZmBD+RBe0leXb2su4u5T/y4ra1Qn7B4C7b687eQWH8Ce2IPVq2sZ6M+zdqri0ln31oU7YP0Doy7ojQvgTW1AtwJlKPsl1wv4ByiM76+QVHsKf6ILK5m+7dK/ZyLrohP0DlMfmqRrGRoTwJ7YgNQCAYaC4cl0n7B+ALB4uigu7mzEhAphD0FaP0WNqJ5vJIgV5NHJ158PY/iGHm0V2MTxMVrepjR1hpYtFDtJwotW30Ayfo5WF7aiVgj+HXijerdbdhMGrvFJA8Q0XS1woFk3EtdjP1A1GRYo6Yf8AsJER3prP9A3hDTerAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgdUHNXcMzkbig5q7huUhc0AR3RAWSuCBF3Dt+wliEoA1bkBPweVfTsgBB2znH6AUImrX9LEBQNq+f5AVl4DPiJydxQc1dw3ORuKDWXcMzkbig+aEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggD/A8Lh7/l7d+XyAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We then plot the sequence of R-hat statistics:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></a>
<a class="sourceLine" id="cb96-2" title="2"><span class="co">#plot the sequence of R-hat statistics</span></a>
<a class="sourceLine" id="cb96-3" title="3">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb96-4" title="4"><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</a>
<a class="sourceLine" id="cb96-5" title="5">  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb96-6" title="6"><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;length-1000&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>, <span class="dt">main=</span><span class="st">&quot;R-hat statistics&quot;</span>)</a>
<a class="sourceLine" id="cb96-7" title="7"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-11.4" class="section level2">
<h2>Exercise 11.4</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Find the intersection points A(k) in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P \left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)\]</span> and <span class="math display">\[S_{k}(a)=P \left(t(k)&gt;\sqrt{\frac{a^{2}k}{k+1-a^{2}}}\right),\]</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely [260].)</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span> We fisrt observe the value range of the intersections with the plot of the curve <span class="math inline">\(S_{k}(x)-S_{k-1}(x)\)</span> :</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">f1&lt;-<span class="cf">function</span>(x,k){</a>
<a class="sourceLine" id="cb97-2" title="2">  a&lt;-<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>x<span class="op">^</span>{<span class="dv">2</span>}<span class="op">/</span>(k<span class="op">-</span>x<span class="op">^</span>{<span class="dv">2</span>}))</a>
<a class="sourceLine" id="cb97-3" title="3">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(a,k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb97-4" title="4">}</a>
<a class="sourceLine" id="cb97-5" title="5">f2&lt;-<span class="cf">function</span>(x,k){</a>
<a class="sourceLine" id="cb97-6" title="6">  a&lt;-<span class="kw">sqrt</span>(k<span class="op">*</span>x<span class="op">^</span>{<span class="dv">2</span>}<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>x<span class="op">^</span>{<span class="dv">2</span>}))</a>
<a class="sourceLine" id="cb97-7" title="7">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(a,k))</a>
<a class="sourceLine" id="cb97-8" title="8">}</a>
<a class="sourceLine" id="cb97-9" title="9"></a>
<a class="sourceLine" id="cb97-10" title="10">f&lt;-<span class="cf">function</span>(x) <span class="kw">f1</span>(x,<span class="dv">4</span>)<span class="op">-</span><span class="kw">f2</span>(x,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb97-11" title="11"><span class="kw">curve</span>(f, <span class="fl">0.01</span>, <span class="fl">1.99</span>, <span class="dt">bty=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>,<span class="dt">main=</span><span class="st">&#39;k=4&#39;</span>)</a>
<a class="sourceLine" id="cb97-12" title="12"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">f&lt;-<span class="cf">function</span>(x) <span class="kw">f1</span>(x,<span class="dv">25</span>)<span class="op">-</span><span class="kw">f2</span>(x,<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb98-2" title="2"><span class="kw">curve</span>(f, <span class="fl">0.01</span>, <span class="kw">sqrt</span>(<span class="dv">25</span>)<span class="op">-</span><span class="fl">0.01</span>, <span class="dt">bty=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>,<span class="dt">main=</span><span class="st">&#39;k=25&#39;</span>)</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">f&lt;-<span class="cf">function</span>(x) <span class="kw">f1</span>(x,<span class="dv">100</span>)<span class="op">-</span><span class="kw">f2</span>(x,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb99-2" title="2"><span class="kw">curve</span>(f, <span class="fl">0.01</span>, <span class="kw">sqrt</span>(<span class="dv">100</span>)<span class="op">-</span><span class="fl">0.01</span>, <span class="dt">bty=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>,<span class="dt">main=</span><span class="st">&#39;k=100&#39;</span>)</a>
<a class="sourceLine" id="cb99-3" title="3"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">f&lt;-<span class="cf">function</span>(x) <span class="kw">f1</span>(x,<span class="dv">500</span>)<span class="op">-</span><span class="kw">f2</span>(x,<span class="dv">500</span>)</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="kw">curve</span>(f, <span class="fl">0.01</span>, <span class="kw">sqrt</span>(<span class="dv">500</span>)<span class="op">-</span><span class="fl">0.01</span>, <span class="dt">bty=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>,<span class="dt">main=</span><span class="st">&#39;k=500&#39;</span>)</a>
<a class="sourceLine" id="cb100-3" title="3"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot we can see that the intersections for all k are below 2. Thus we use the function uniroot to solve the intersections with the range set at [0.01,1.99]:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">root&lt;-<span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb101-2" title="2">  f1&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb101-3" title="3">    a&lt;-<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>x<span class="op">^</span>{<span class="dv">2</span>}<span class="op">/</span>(k<span class="op">-</span>x<span class="op">^</span>{<span class="dv">2</span>}))</a>
<a class="sourceLine" id="cb101-4" title="4">    <span class="kw">return</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(a,k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb101-5" title="5">  }</a>
<a class="sourceLine" id="cb101-6" title="6">  f2&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb101-7" title="7">    a&lt;-<span class="kw">sqrt</span>(k<span class="op">*</span>x<span class="op">^</span>{<span class="dv">2</span>}<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>x<span class="op">^</span>{<span class="dv">2</span>}))</a>
<a class="sourceLine" id="cb101-8" title="8">    <span class="kw">return</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(a,k))</a>
<a class="sourceLine" id="cb101-9" title="9">  }</a>
<a class="sourceLine" id="cb101-10" title="10">  f&lt;-<span class="cf">function</span>(x) <span class="kw">f1</span>(x)<span class="op">-</span><span class="kw">f2</span>(x)</a>
<a class="sourceLine" id="cb101-11" title="11">  <span class="kw">return</span>(<span class="kw">uniroot</span>(f,<span class="dt">lower =</span> <span class="fl">0.001</span>, <span class="dt">upper =</span> <span class="fl">1.999</span>))</a>
<a class="sourceLine" id="cb101-12" title="12">}</a>
<a class="sourceLine" id="cb101-13" title="13">k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb101-14" title="14">a&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb101-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</a>
<a class="sourceLine" id="cb101-16" title="16">  a[i]=<span class="kw">root</span>(k[i])<span class="op">$</span>root</a>
<a class="sourceLine" id="cb101-17" title="17">}</a>
<a class="sourceLine" id="cb101-18" title="18">result&lt;-<span class="kw">matrix</span>(a, <span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&#39;intersections&#39;</span>),<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)))</a>
<a class="sourceLine" id="cb101-19" title="19"><span class="kw">print</span>(result)</a></code></pre></div>
<pre><code>##                      4        5        6       7        8        9      10
## intersections 1.492103 1.533556 1.562744 1.58443 1.601185 1.614521 1.62539
##                     11       12       13      14       15       16       17
## intersections 1.634418 1.642038 1.648554 1.65419 1.659114 1.663452 1.667303
##                     18      19       20       21       22       23       24
## intersections 1.670745 1.67384 1.676637 1.679178 1.681496 1.683619 1.685572
##                     25      100      500     1000
## intersections 1.687373 1.720608 1.729755 1.730907</code></pre>
</div>
<div id="section-7" class="section level2">
<h2>11-24</h2>
</div>
<div id="exercise-a-b-o-blood-type-problem" class="section level2">
<h2>Exercise A-B-O blood type problem</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Use EM algorithm to solve MLE of p and q. Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> Denote <span class="math inline">\(\Delta =\{n_{AA},n_{BB},n_{OO},n_{AB},n_{AO},n_{BO}\}\)</span> be all the data we need to conduct MLE. Then we have the complete data likelihood: <span class="math display">\[L(p,q|\Delta)=p^{2n_{AA}}q^{2n_{BB}}r^{2n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}}.\]</span> <span class="math display">\[l(p,q|\Delta)=2n_{AA}\log p+2n_{BB}\log q+2n_{OO}\log r+n_{AO}\log pr+n_{BO}\log qr+n_{AB}\log pq+(n_{AO}+n_{BO}+n_{AB})\log 2.\]</span> <span class="math display">\[\begin{align}
l(p,q|\Delta)=&amp;2n_{AA}\log p+2n_{BB}\log q+2n_{OO}\log r+n_{AO}\log pr+n_{BO}\log qr+n_{AB}\log pq+(n_{AO}+n_{BO}+n_{AB})\log 2\nonumber\\
=&amp;n_{AA}\log \frac{p}{r}+n_{BB}\log \frac{q}{r}+2n_{OO}\log r+n_{A\cdot }\log pr+n_{B\cdot }\log qr+n_{AB}\log pq+(n_{AO}+n_{BO}+n_{AB})\log 2.\nonumber
\end{align}\]</span></p>
<p>For the <span class="math inline">\((k+1)\)</span>th E-step, assume we have the estimation of p annd q in the <span class="math inline">\(k\)</span>th iteration: <span class="math inline">\(\hat{p}_{k}, \hat{q}_{k}\)</span>, then we have: <span class="math display">\[n^{k+1}_{AA}=E[n_{AA}|n_{A\cdot},\hat{p}_{k},\hat{q}_{k}]=n_{A\cdot}\frac{\hat{p}^{2}_{k}}{\hat{p}^{2}_{k}+2\hat{p}_{k}\hat{r}_{k}}=n_{A\cdot}\frac{\hat{p}_{k}}{2-\hat{p}_{k}-2\hat{q}_{k}}.\]</span> <span class="math display">\[n^{k+1}_{BB}=E[n_{BB}|n_{B\cdot},\hat{p}_{k},\hat{q}_{k}]=n_{B\cdot}\frac{\hat{q}^{2}_{k}}{\hat{q}^{2}_{k}+2\hat{q}_{k}\hat{r}_{k}}=n_{B\cdot}\frac{\hat{q}_{k}}{2-\hat{q}_{k}-2\hat{p}_{k}}.\]</span></p>
<p>For the <span class="math inline">\((k+1)\)</span>th M-step, we have the MLE of p and q determined by the following equations: <span class="math display">\[ \left\{ \begin{array}{l}
n^{k+1}_{AA}+n_{A\cdot}+n_{AB}=(n^{k+1}_{AA}+n_{A\cdot}+n_{AB})\hat{q}_{k+1}+(2n_{OO}+2n_{A\cdot}+n_{B\cdot}+n_{AB}-n^{k+1}_{BB})\hat{p}_{k+1}\\
n^{k+1}_{BB}+n_{B\cdot}+n_{AB}=(n^{k+1}_{BB}+n_{B\cdot}+n_{AB})\hat{p}_{k+1}+(2n_{OO}+2n_{B\cdot}+n_{A\cdot}+n_{AB}-n^{k+1}_{AA})\hat{q}_{k+1}.\end{array} \right. \]</span></p>
<p>If we assume <span class="math inline">\(a=n^{k+1}_{AA}+n_{A\cdot}+n_{AB}, b=2n_{OO}+2n_{A\cdot}+n_{B\cdot}+n_{AB}-n^{k+1}_{BB}, c=n^{k+1}_{BB}+n_{B\cdot}+n_{AB}, d=2n_{OO}+2n_{B\cdot}+n_{A\cdot}+n_{AB}-n^{k+1}_{AA}\)</span>, then the solution of the above equations are: <span class="math display">\[ \left\{ \begin{array}{l}
\hat{p}_{k+1}=\frac{ad-ac}{bd-ac}\\
\hat{q}_{k+1}=\frac{bc-ac}{bd-ac}.\end{array} \right. \]</span></p>
<p>Repeat this process until convergence, we get the following EM algorithm:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">iteration=<span class="dv">15</span></a>
<a class="sourceLine" id="cb103-2" title="2">n_A=<span class="dv">444</span></a>
<a class="sourceLine" id="cb103-3" title="3">n_B=<span class="dv">132</span></a>
<a class="sourceLine" id="cb103-4" title="4">n_OO=<span class="dv">361</span></a>
<a class="sourceLine" id="cb103-5" title="5">n_AB=<span class="dv">63</span></a>
<a class="sourceLine" id="cb103-6" title="6">p&lt;-<span class="kw">numeric</span>(iteration<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb103-7" title="7">q&lt;-<span class="kw">numeric</span>(iteration<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb103-8" title="8">n_AA&lt;-<span class="kw">numeric</span>(iteration)</a>
<a class="sourceLine" id="cb103-9" title="9">n_BB&lt;-<span class="kw">numeric</span>(iteration)</a>
<a class="sourceLine" id="cb103-10" title="10">loglh&lt;-<span class="kw">numeric</span>(iteration)</a>
<a class="sourceLine" id="cb103-11" title="11">p[<span class="dv">1</span>]&lt;-q[<span class="dv">1</span>]&lt;-<span class="fl">0.5</span></a>
<a class="sourceLine" id="cb103-12" title="12"></a>
<a class="sourceLine" id="cb103-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>iteration) {</a>
<a class="sourceLine" id="cb103-14" title="14">  <span class="co"># E-step: update the value of missing data (n_AA,n_BB)</span></a>
<a class="sourceLine" id="cb103-15" title="15">  n_AA[i]=n_A<span class="op">*</span>p[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p[i]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>q[i])</a>
<a class="sourceLine" id="cb103-16" title="16">  n_BB[i]=n_B<span class="op">*</span>q[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>q[i]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>p[i])</a>
<a class="sourceLine" id="cb103-17" title="17">  <span class="co"># M-step: update p and q  </span></a>
<a class="sourceLine" id="cb103-18" title="18">  a&lt;-n_AA[i]<span class="op">+</span>n_A<span class="op">+</span>n_AB</a>
<a class="sourceLine" id="cb103-19" title="19">  b&lt;-<span class="dv">2</span><span class="op">*</span>n_OO<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n_A<span class="op">+</span>n_B<span class="op">+</span>n_AB<span class="op">-</span>n_BB[i]</a>
<a class="sourceLine" id="cb103-20" title="20">  c&lt;-n_BB[i]<span class="op">+</span>n_B<span class="op">+</span>n_AB</a>
<a class="sourceLine" id="cb103-21" title="21">  d&lt;-<span class="dv">2</span><span class="op">*</span>n_OO<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n_B<span class="op">+</span>n_A<span class="op">+</span>n_AB<span class="op">-</span>n_AA[i]</a>
<a class="sourceLine" id="cb103-22" title="22">  pt&lt;-p[i<span class="op">+</span><span class="dv">1</span>]&lt;-(a<span class="op">*</span>d<span class="op">-</span>a<span class="op">*</span>c)<span class="op">/</span>(b<span class="op">*</span>d<span class="op">-</span>a<span class="op">*</span>c)</a>
<a class="sourceLine" id="cb103-23" title="23">  qt&lt;-q[i<span class="op">+</span><span class="dv">1</span>]&lt;-(b<span class="op">*</span>c<span class="op">-</span>a<span class="op">*</span>c)<span class="op">/</span>(b<span class="op">*</span>d<span class="op">-</span>a<span class="op">*</span>c)</a>
<a class="sourceLine" id="cb103-24" title="24">  r&lt;-<span class="dv">1</span><span class="op">-</span>pt<span class="op">-</span>qt</a>
<a class="sourceLine" id="cb103-25" title="25">  loglh[i]&lt;-n_AA[i]<span class="op">*</span><span class="kw">log</span>(pt<span class="op">/</span>r)<span class="op">+</span>n_BB[i]<span class="op">*</span><span class="kw">log</span>(qt<span class="op">/</span>r)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n_OO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>n_A<span class="op">*</span><span class="kw">log</span>(pt<span class="op">*</span>r)<span class="op">+</span></a>
<a class="sourceLine" id="cb103-26" title="26"><span class="st">    </span>n_B<span class="op">*</span><span class="kw">log</span>(qt<span class="op">*</span>r)<span class="op">+</span>n_AB<span class="op">*</span><span class="kw">log</span>(pt<span class="op">*</span>qt)<span class="op">+</span>(n_A<span class="op">+</span>n_B<span class="op">+</span>n_AB<span class="op">-</span>n_AA[i]<span class="op">-</span>n_BB[i])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb103-27" title="27">}</a></code></pre></div>
<p>We print the result of p, q and log-likelihood:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">print</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(p[<span class="op">-</span><span class="dv">1</span>],q[<span class="op">-</span><span class="dv">1</span>],loglh),<span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span>T, <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;q&#39;</span>,<span class="st">&#39;llh&#39;</span>),<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>)))</a></code></pre></div>
<pre><code>##              1             2             3             4             5
## p       0.4755     0.3416511     0.3062087     0.2992214     0.2979287
## q       0.1635     0.1096863     0.1034977     0.1028196     0.1027251
## llh -1991.1016 -1573.5545018 -1455.0894900 -1432.6652401 -1428.6108671
##                 6             7             8             9            10
## p       0.2976930     0.2976502     0.2976424     0.2976410     0.2976407
## q       0.1027096     0.1027069     0.1027064     0.1027063     0.1027063
## llh -1427.8778434 -1427.7450074 -1427.7209096 -1427.7165364 -1427.7157427
##                11            12            13            14            15
## p       0.2976407     0.2976407     0.2976407     0.2976407     0.2976407
## q       0.1027063     0.1027063     0.1027063     0.1027063     0.1027063
## llh -1427.7155986 -1427.7155725 -1427.7155677 -1427.7155669 -1427.7155667</code></pre>
<p><span class="math inline">\(\ \)</span></p>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise 3</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb106-2" title="2">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb106-3" title="3">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb106-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb106-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb106-6" title="6">)</a></code></pre></div>
<p><span class="math inline">\(\textbf{Solve:}\)</span> With loos:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="cf">for</span>(x <span class="cf">in</span> formulas){</a>
<a class="sourceLine" id="cb107-2" title="2">  <span class="kw">print</span>(<span class="kw">lm</span>(x, mtcars))</a>
<a class="sourceLine" id="cb107-3" title="3">}</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>With lapply:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(x,mtcars))</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p><span class="math inline">\(\ \)</span></p>
</div>
<div id="exercise-3-1" class="section level2">
<h2>Exercise 3*</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb111-2" title="2">  <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb111-3" title="3">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb111-4" title="4">  <span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb111-5" title="5">)</a>
<a class="sourceLine" id="cb111-6" title="6"><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code>##   [1] 0.927765569 0.112508825 0.990355760 0.737648966 0.756896901 0.942169742
##   [7] 0.653441071 0.097197255 0.852659182 0.091680217 0.949351228 0.808957574
##  [13] 0.877451079 0.015583812 0.815487026 0.115365625 0.863319065 0.227289865
##  [19] 0.746082835 0.119263988 0.271866793 0.307519748 0.378430718 0.086581664
##  [25] 0.687572485 0.760453941 0.789395417 0.431531429 0.445523939 0.431920654
##  [31] 0.244296604 0.119588658 0.298901215 0.009807865 0.141602761 0.735164087
##  [37] 0.954435720 0.513312724 0.761630645 0.068407069 0.671960887 0.224555363
##  [43] 0.710380890 0.899725251 0.181005304 0.249544855 0.359190525 0.099339455
##  [49] 0.690896679 0.107424601 0.311849104 0.965561645 0.543593040 0.403042577
##  [55] 0.853334736 0.222363815 0.161591498 0.906151487 0.360125399 0.011801625
##  [61] 0.206999239 0.229806796 0.623974363 0.988364704 0.585557931 0.841209860
##  [67] 0.301586693 0.941068906 0.585445988 0.840476097 0.390446982 0.596836441
##  [73] 0.259057445 0.650753282 0.015523389 0.167363214 0.854524151 0.848181682
##  [79] 0.581650557 0.601333594 0.891649517 0.519130832 0.937962824 0.012975765
##  [85] 0.414300435 0.239365811 0.046547723 0.754899578 0.942869280 0.804138410
##  [91] 0.052397192 0.982322184 0.795398001 0.590074109 0.645885822 0.619688007
##  [97] 0.811465236 0.978772116 0.434673037 0.230227603</code></pre>
<p><span class="math inline">\(\ \)</span></p>
</div>
<div id="exercise-6" class="section level2">
<h2>Exercise 6*</h2>
<p><span class="math inline">\(\textbf{Qusetion:}\)</span> Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
<p><span class="math inline">\(\textbf{Solve:}\)</span> We use the dataset mtcars and faithful as the example, what we expect is something like the following result:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">datalist &lt;-<span class="st"> </span><span class="kw">list</span>(mtcars, faithful)</a>
<a class="sourceLine" id="cb113-2" title="2"><span class="kw">lapply</span>(datalist, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)))</a></code></pre></div>
<pre><code>## [[1]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[2]]
## eruptions   waiting 
##  3.487783 70.897059</code></pre>
<p>We can get similar result with a the following function:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">mylapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb115-2" title="2">  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</a>
<a class="sourceLine" id="cb115-3" title="3">  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="kw">return</span>(<span class="kw">simplify2array</span>(out))</a>
<a class="sourceLine" id="cb115-4" title="4">  <span class="kw">unlist</span>(out)</a>
<a class="sourceLine" id="cb115-5" title="5">}</a>
<a class="sourceLine" id="cb115-6" title="6"><span class="kw">mylapply</span>(datalist, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</a></code></pre></div>
<pre><code>##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb  eruptions    waiting 
##   0.437500   0.406250   3.687500   2.812500   3.487783  70.897059</code></pre>
</div>
<div id="section-8" class="section level2">
<h2>12-01</h2>
</div>
<div id="exercise-1" class="section level2">
<h2>Exercise：</h2>
<p><span class="math inline">\(\textbf{Question: }\)</span> Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> We write the following function with Rcpp and print the results:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">library</span>(Rcpp) </a>
<a class="sourceLine" id="cb117-2" title="2"></a>
<a class="sourceLine" id="cb117-3" title="3"><span class="kw">cppFunction</span>(<span class="st">&#39;NumericVector rwMetropolis(double sigma, double x0, int N) {</span></a>
<a class="sourceLine" id="cb117-4" title="4"><span class="st">  NumericVector x(N);</span></a>
<a class="sourceLine" id="cb117-5" title="5"><span class="st">  x[0] = x0;</span></a>
<a class="sourceLine" id="cb117-6" title="6"><span class="st">  NumericVector u=runif(N);</span></a>
<a class="sourceLine" id="cb117-7" title="7"><span class="st">  for (int i=1;i&lt;N;i++) {</span></a>
<a class="sourceLine" id="cb117-8" title="8"><span class="st">    NumericVector y = rnorm(1, x[i-1], sigma);</span></a>
<a class="sourceLine" id="cb117-9" title="9"><span class="st">    if (u[i] &lt;= (exp(-abs(y[0])) / exp(-abs(x[i-1])))){</span></a>
<a class="sourceLine" id="cb117-10" title="10"><span class="st">      x[i] = y[0];</span></a>
<a class="sourceLine" id="cb117-11" title="11"><span class="st">    } </span></a>
<a class="sourceLine" id="cb117-12" title="12"><span class="st">    else {</span></a>
<a class="sourceLine" id="cb117-13" title="13"><span class="st">        x[i] = x[i-1];</span></a>
<a class="sourceLine" id="cb117-14" title="14"><span class="st">    }</span></a>
<a class="sourceLine" id="cb117-15" title="15"><span class="st">  }</span></a>
<a class="sourceLine" id="cb117-16" title="16"><span class="st">  return(x);</span></a>
<a class="sourceLine" id="cb117-17" title="17"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb117-18" title="18"></a>
<a class="sourceLine" id="cb117-19" title="19"><span class="kw">set.seed</span>(<span class="dv">2001</span>)</a>
<a class="sourceLine" id="cb117-20" title="20">N &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb117-21" title="21">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.3</span>, <span class="fl">1.5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb117-22" title="22">x0 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb117-23" title="23">rw1 &lt;-<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb117-24" title="24">rw2 &lt;-<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb117-25" title="25">rw3 &lt;-<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb117-26" title="26">rw4 &lt;-<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb117-27" title="27">index=<span class="dv">1</span><span class="op">:</span>N</a>
<a class="sourceLine" id="cb117-28" title="28"><span class="kw">plot</span>(index, rw1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.05 (C)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZjpmZmZmZrZmkLZmtrZmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2Zma2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb2//b/9vb////tmb/25D/27b//7b//9v///+SHPIiAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAK0ElEQVR4nO2di3bbuBVFoYxTq+60qd2mr9idmWastE2jJNNajoT//68SL5LgAwcgQQmyzlnLWiIBXABbwAVAwqSQVFDi1AUoXQQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEdERAhwfx+mlayg9CrP76NHS8FVrXLmh/t3pUMb7cVGe//1h9fV6/+jSj1OcAqEroQWgfbzqAtjqP/R/NaXGrY9/OKPU5dLGtWL2Xn4W47x/v7/zaGxqWoNK9YzZVywP6XDX21e8+1i1I9Y+rx4149amq3fXXG7F6Jz+vq1Mq8lf103//qDqGreHqsUp3rVPbZtI+rqLdtzPbCdXDqn539V7KbxWnKsdunDQtDsg6icoPGEDm113dGEBGNzZGVT8LpQ3ItpKNawjt4yrBb6yvsbmZjIzbOfz9zX/7rSxNSwNSreRJflHewACqqnT9dNgIC+hWhYl3iqOO8Sv9i9+2AeljBcQ62/bxpiaqZZqVyrNdhs2cPrY0oKo2V/82Xw0gU8+qDhpQdcJ82lpL+cu/boRfvwCgw4/rq4/y67rVuK5lY8uqTjlFSwMyPeo7NSZrQG4ocz7Ir9Thx86gpBRqQUZb14RMUBdQHTxFi/ugb2bEXf1sALnmPwhI0bz6xy/qRGQXM9r5gLpdrGxAFaKflBO2jSfYglr1i3TSRh1ALSetRs/iAVU6/KAcxoAP8gHt9Lyl66Tr0a8Z5t3x89v1UOPyh/myAVV1/v2T6meu8fijWK8FvX5S1fJ6iKrgOzMxNCa842rO+GXtEtjO5U8Uy3bS8kM9EA/Ng/o+qO+kW0uLtgkdyTY019lcM6uXGm/UUdHDvJT1srE1k/7tx/FR7Or9tvuLHz6szeK0NrF2i9Vvbyvab+r6u2WFXazqCca8xdip1mKzftVx7QbczfN6hgs6PqCNbvfP6043yqSqtfTWXbvCF6sd7erRaRHz2z74zZld7vj2dm2X90tof9cdsc7ngtl5ioCACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAgoMyBxNjoVoLzmlhMBAREQ0AUCSsv6YgHFFoCAomLnjHgSc8lZRw/flwfITG0IaDxnAgI5ExDK2QCKLAEBwejRdrPqZICEBRRbgkUA1f/GLcTYf2CdFJDQgOKKsEwLOjygXf0XDqgiBP5H59IByR14ysNpAQmDKaYQl+ikJQGBjAsGlH6pN7dagKJKccktiIBGMxY1prj40YYjVfREUX+cGFDRE0X9cWpAJU8Um4+oYezCJoqiGEBHNhedrWgBiirFBQOSUdcVLxNQc4hTRJueUJzjmYvOVoQOB1NEm04vzRHNRWfbyZeAutkSUDhXAgK5EhDIlYBArt1sCQjkWjyg3JyAPQIiIGQ2aLAfSkAglIBAKAGBUP/qx2Ca6KxjIyaZyw8oWNlhQOE00VnHRkwyR0BdK/6d1ew3WM8eUMdc7lvQ4E5OP8xuZUhKMzdikrlTA5KlA8psFmyLGgUUSERAYBPDDED/zPFw4RIABRMlAtr/xR1nevqySCsFtJoMSJgdiylpQhHte91mvmFBngbQUFhuQM3bumY+aX4xQAFbRwGk3yfwp/kPmvcAZRvsAaChc/kBtd4NM0MvGNBWtaB5DkguAshW9MSA6pekzHnDQitfPNdPMXl6QNlHMTzXTzFZAKDc8yA7lZ1hqWVSBAEN5iLCaU4/k5bZtpW7GfGoseHzCwKapeyAxERAoFuePyDRmOkPid6JEKA0xzUvYqK5YwCC0/ULASRGAQkvywEjRQOaN8y/eEDISQIrzeV/MdCVGkDxF0LEaAgqS1aJwFGKlSFAPnwXFHu/o0hAPeuoT9TRMKDOnaYRQ8cG5N7zOfoPG1kACQ/QwHg+CdDExp0E6PnX6m336i3mY+uRKEDov01Ec3mjPZupqyhKBXR40Gv9TfW5Gbl0dFxAcL3nVqziOID2d7prbdULif0mNPZzZgbUJhULyK1TOjEXbUHXpp9FmOse5gIkjCOPAGSvexwHkNyqq0bKEe3vIruY6B6KCYDq063ZoxQevDFLUtQtzSe00Cim3iK7CvCJBoRcawyggQz6xRG+xgoaMpFVPUB+u44CJNoApAfI9dGhyVHA2AChIgG5tUEYkMCAoO/pWmu6mWwZjjMQG3GSOa8eflHHTThADo7wA6YAajrbWQEazruJ5AZ0L0TaWU00IINa1MmLBiTTAIkMgOTZABLRgOq/no9vqpgKSJYJqF3FLIBkKiBZOCA5AqjlfXvLk1FAjs443JEyOSad4TEydVaFAEnpng9Vt4KhtuDOuXVUx5hILnM9CpYPyB12AQkvigwDin6WZLdMZQKSPiCZAVCC++mWpUlcGKCOcwwBEgsCag0axQJy55zD9kA0gEyi/pjoPqYXsEhAogNISjetdt/qkxcLqOtaRT2pEQ2hBpo9GrL+4gCJKEAOiT/3HsxiXpGLBdSb8zXrrcsGJEOApL1ANAJoOIssRT4PQLLVhlrr7XDZ8pR4IUAbIa713dWxW6vRgGQEoBwlnm0lKTt1R2xj9guPbBceBOTcjX+6A6i1ys9Y4vlWUrLT98V2esOwQhVprq5877T79G7OJJRnjhYBpO+smnuqkXdWbZgcukzv/LJ0nnrmKiJNBbUgKUb2OYl2gjG8S2lhH2RvQseZE819wECC4/IpaRQLT1xeGKBJ5iIrTkAoKQGhpBcLKDYpASUnXU4lASpSBAREQEAEBHQyQGejEwGKMwrC5wXPTT4veh6jBDQvnIAIaF44ARHQvHACIqB54S8f0EsSAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERBQfkA7kfhYar0j69ZL2v8S1kbvCJycPKTsgNQexl1KqQ4PVeyt2thXJ+1/AXkKBWhy8qByAzK7F8eevzSk57Xaz7d99alO2v8S1v5OAZqcPKzcgOrqJqarfug6af9LOO329Q8VoMnJw8oOSD3mrLuNOkKbqj4uaf8LylL5oKnJgXIDMl0+uePvKi9dJ+1/CSVVHUkBmpgcqQxAO+ejJ9RQb94+H0CTmvVOj/LT+oiOc0ZdbIpj3JpZ0DQvu7XbWe7PxElPGFq3dt/+jHF6cz7DfPrk7Hnt/u9j+kxvcz4TRd3mk8pk+4hKUyftfwnLLDUmJw+Ji1UgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiIKDiANk3TbY0d/vBPBUHqC8CAiIgT6qL7e/+dmceh6r2r/xkd8aofWhqu9jow6wXUaGA1Ob76k+9Mnkn7IHaaaU2jY09iXgZFQroVm9ZNJsMN6tH02jUdszdq//84ag9rlBA9/qLfbi329CreenHNR9RRQPa1oDcVla1ZXj0Xe6LqGhAnRakdHj487xtvakqGpDd6Kx8kGs229f/G3sa+jIqGpAevOpRzHjr+7lb5xNVNiB/HlSBMTvGj+mmiwNUmggIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICOj/kI1V1UhQ/+AAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">plot</span>(index, rw2, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.3 (C)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">plot</span>(index, rw3, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=1.5 (C)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">plot</span>(index, rw4, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=10 (C)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Question: }\)</span> Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> From the previous plot we can see that the result is similar. We plot the result of the R function. We further use the function ‘qqplot’ to compare the result with the R function.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">f&lt;-<span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb121-2" title="2">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb121-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb121-4" title="4">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb121-5" title="5">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb121-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb121-7" title="7">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb121-8" title="8">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb121-9" title="9">      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb121-10" title="10">        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb121-11" title="11">      }</a>
<a class="sourceLine" id="cb121-12" title="12">  }</a>
<a class="sourceLine" id="cb121-13" title="13">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb121-14" title="14">}</a>
<a class="sourceLine" id="cb121-15" title="15"><span class="kw">set.seed</span>(<span class="dv">2001</span>)</a>
<a class="sourceLine" id="cb121-16" title="16">N &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb121-17" title="17">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.3</span>, <span class="fl">1.5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb121-18" title="18">x0 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb121-19" title="19">rw<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb121-20" title="20">rw<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb121-21" title="21">rw<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb121-22" title="22">rw<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N) <span class="co">#result of the R function</span></a>
<a class="sourceLine" id="cb121-23" title="23">index=<span class="dv">1</span><span class="op">:</span>N</a>
<a class="sourceLine" id="cb121-24" title="24"><span class="kw">plot</span>(index, rw<span class="fl">.1</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.05 (R)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">plot</span>(index, rw<span class="fl">.2</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.3 (R)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">plot</span>(index, rw<span class="fl">.3</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=1.5 (R)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">plot</span>(index, rw<span class="fl">.4</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=10 (R)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We now compare the results of the two methods by qqplots:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">qqplot</span>(rw1,rw<span class="fl">.1</span>,<span class="dt">main=</span><span class="st">&#39;sigma=0.05&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;Rcpp&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;R&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">qqplot</span>(rw2,rw<span class="fl">.2</span>,<span class="dt">main=</span><span class="st">&#39;sigma=0.3&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;Rcpp&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;R&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">qqplot</span>(rw3,rw<span class="fl">.3</span>,<span class="dt">main=</span><span class="st">&#39;sigma=1.5&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;Rcpp&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;R&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">qqplot</span>(rw4,rw<span class="fl">.4</span>,<span class="dt">main=</span><span class="st">&#39;sigma=10&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;Rcpp&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;R&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the qqplots we can see that the results of two methods are very similar.</p>
<p><span class="math inline">\(\textbf{Question: }\)</span> Campare the computation time of the two functions with the function “microbenchmark”.</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> We now compare the computation time of the two methods:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb129-2" title="2">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N),<span class="dt">rwC=</span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">1</span>], x0, N))</a>
<a class="sourceLine" id="cb129-3" title="3"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr        lq   median        uq
## 1  rwR 31.644951 33.57540 41.243101
## 2  rwC  1.851351  1.96595  2.084801</code></pre>
<p>From the results we can see that the C function via Rcpp is much faster than the R function.</p>
<p><span class="math inline">\(\textbf{Question: }\)</span> Comments your results.</p>
<p><span class="math inline">\(\textbf{Solve: }\)</span> To summarize: The C function via Rcpp generate almost the same result with the R function while reduce the computation time greatly.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
